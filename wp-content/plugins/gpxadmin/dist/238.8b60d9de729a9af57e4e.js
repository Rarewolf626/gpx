"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[238],{238:(e,n,t)=>{t.r(n),t.d(n,{default:()=>W});var r=t(7829),o=t(3102),l=t(9608),a=t(6685);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){d(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function d(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==u(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var c=["disabled"],f={class:"col-md-6 col-md-offset-3"},v={class:"form-group"},p=(0,r.Lk)("label",{for:"region-CountryID",class:"control-label required"},"Country",-1),m=["value","textContent"],g=["textContent"],y=["for"],b=["id","onChange"],k=(0,r.Lk)("option",{value:""},null,-1),C=["value","textContent","selected"],L=["textContent"],h={class:"row"},_={class:"col-md-6"},w={class:"form-group"},x=(0,r.Lk)("label",{for:"region-name",class:"control-label required"},"Region Name",-1),D=["textContent"],E={class:"col-md-6"},O={class:"form-group"},I=(0,r.Lk)("label",{for:"region-displayName",class:"control-label"},"Display Name",-1),j=["textContent"],N={class:"row"},X={class:"col-md-4"},P={class:"form-group"},S=(0,r.Lk)("label",{for:"region-featured",class:"control-label"},"Featured",-1),R=[(0,r.Lk)("option",{value:!0},"Yes",-1),(0,r.Lk)("option",{value:!1},"No",-1)],H=["textContent"],K={class:"col-md-4"},Q={class:"form-group"},q=(0,r.Lk)("label",{for:"region-ddHidden",class:"control-label"},"Hidden",-1),F=[(0,r.Lk)("option",{value:!0},"Yes",-1),(0,r.Lk)("option",{value:!1},"No",-1)],U=["textContent"],V={class:"col-md-4"},T={class:"form-group"},Y=(0,r.Lk)("label",{for:"region-show_resort_fees",class:"control-label"},"Show Resort Fees",-1),A=[(0,r.Lk)("option",{value:!0},"Yes",-1),(0,r.Lk)("option",{value:!1},"No",-1)],J=["textContent"],$=(0,r.Lk)("div",{class:"form-help"},"This will affect all resorts in this region and its children.",-1),z=(0,r.Lk)("div",{class:"ln_solid"},null,-1),B={class:"col-md-6 col-md-offset-3"},G=["disabled"],M=["textContent"];const W={__name:"RegionEdit",props:{region:{type:Object,required:!0},countries:{type:Array,required:!0},regions:{type:Array,required:!0}},setup:function(e){var n=e,t=(0,a.KR)(!1),u=(0,a.KR)(!1),i=(0,a.KR)({name:n.region.name,CountryID:n.region.CountryID,parent:n.region.parent,displayName:n.region.displayName,ddHidden:n.region.ddHidden,featured:n.region.featured,show_resort_fees:n.region.show_resort_fees}),d=(0,a.KR)({}),W=(0,a.KR)(""),Z=(0,a.KR)(n.region.ancestors.map((function(e){return{id:e.id,name:e.name,parent:e.parent,siblings:n.regions.filter((function(t){return t.id!==n.region.id&&(1===e.parent?t.CountryID===e.CountryID&&1===t.parent:t.parent===e.parent)})).sort((function(e,n){var t=e.lft;return n.lft-t}))}}))),ee=function(e){var t=n.countries.find((function(n){return n.id==e.target.value}));Z.value=[{id:e.target.value,name:null==t?void 0:t.name,parent:null,siblings:n.regions.filter((function(t){return t.id!==n.region.id&&(1===t.parent&&t.CountryID==e.target.value)})).sort((function(e,n){var t=e.lft;return n.lft-t}))}],i.value.parent=null},ne=function(){t.value=!0,u.value=!1,W.value="",d.value={},axios.post("/gpxadmin/region/update/",s(s({},i.value),{},{id:n.region.id})).then((function(e){console.log(e.data),W.value=e.data.message||"Region was updated.",u.value=e.data.success,t.value=!1,setTimeout((function(){W.value=""}),4e3)})).catch((function(e){console.log(e),u.value=!1,422===e.response.status?d.value=e.response.data.errors:(W.value=e.response.data.message||"Failed to save region.",setTimeout((function(){W.value=""}),4e3)),t.value=!1}))};return function(a,s){return(0,r.uX)(),(0,r.CE)("form",{onSubmit:(0,o.D$)(ne,["prevent"]),novalidate:""},[(0,r.Lk)("fieldset",{class:"row",disabled:t.value},[(0,r.Lk)("div",f,[(0,r.Lk)("div",v,[p,(0,r.Lk)("div",null,[(0,r.bo)((0,r.Lk)("select",{id:"region-CountryID",name:"CountryID",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=function(e){return i.value.CountryID=e}),onChange:ee},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.countries,(function(e){return(0,r.uX)(),(0,r.CE)("option",{key:e.id,value:e.id,textContent:(0,l.v_)(e.name)},null,8,m)})),128))],544),[[o.u1,i.value.CountryID,void 0,{number:!0}]])]),d.value.CountryID?((0,r.uX)(),(0,r.CE)("div",{key:0,textContent:(0,l.v_)(d.value.CountryID[0]),class:"form-error"},null,8,g)):(0,r.Q3)("",!0)]),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(Z.value,(function(e,t){return(0,r.uX)(),(0,r.CE)("div",{key:e.id,class:"form-group"},[(0,r.Lk)("label",{for:"region-parent-".concat(e.id),class:(0,l.C4)(["control-label",{required:0===t}])},"Parent Region",10,y),(0,r.Lk)("div",null,[(0,r.Lk)("select",{id:"region-parent-".concat(e.id),class:"form-control",onChange:function(t){return function(e,t){var r=e?n.regions.find((function(n){return n.id==e})):n.regions.find((function(e){return e.id==t})),o=[],l=r;do{o.push({id:l.id,name:l.name,parent:l.parent,siblings:n.regions.filter((function(e){return e.id!==n.region.id&&(1===l.parent?e.CountryID===l.CountryID&&1===e.parent:e.parent===l.parent)})).sort((function(e,n){var t=e.lft;return n.lft-t}))}),l=n.regions.find((function(e){return e.id==l.parent}))}while(l);o.reverse(),l=r,n.regions.find((function(e){return e.parent==l.id}))&&o.push({id:t,name:null,parent:l.id,siblings:n.regions.filter((function(e){return e.id!==n.region.id&&1!==e.parent&&l.id===e.parent})).sort((function(e,n){var t=e.lft;return n.lft-t}))}),Z.value=o,i.value.parent=e||null}(parseInt(t.target.value),e.parent)}},[k,((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.siblings,(function(n){return(0,r.uX)(),(0,r.CE)("option",{key:n.id,value:n.id,textContent:(0,l.v_)(n.name),selected:n.id===e.id},null,8,C)})),128))],40,b)])])})),128)),d.value.parent?((0,r.uX)(),(0,r.CE)("div",{key:0,textContent:(0,l.v_)(d.value.parent[0]),class:"form-error"},null,8,L)):(0,r.Q3)("",!0),(0,r.Lk)("div",h,[(0,r.Lk)("div",_,[(0,r.Lk)("div",w,[x,(0,r.Lk)("div",null,[(0,r.bo)((0,r.Lk)("input",{type:"text",id:"region-name",name:"name",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=function(e){return i.value.name=e}),required:"",maxlength:"255"},null,512),[[o.Jo,i.value.name]]),d.value.name?((0,r.uX)(),(0,r.CE)("div",{key:0,textContent:(0,l.v_)(d.value.name[0]),class:"form-error"},null,8,D)):(0,r.Q3)("",!0)])])]),(0,r.Lk)("div",E,[(0,r.Lk)("div",O,[I,(0,r.Lk)("div",null,[(0,r.bo)((0,r.Lk)("input",{type:"text",id:"region-displayName",name:"displayName",class:"form-control","onUpdate:modelValue":s[2]||(s[2]=function(e){return i.value.displayName=e}),maxlength:"255"},null,512),[[o.Jo,i.value.displayName]]),d.value.displayName?((0,r.uX)(),(0,r.CE)("div",{key:0,textContent:(0,l.v_)(d.value.displayName[0]),class:"form-error"},null,8,j)):(0,r.Q3)("",!0)])])])]),(0,r.Lk)("div",N,[(0,r.Lk)("div",X,[(0,r.Lk)("div",P,[S,(0,r.Lk)("div",null,[(0,r.bo)((0,r.Lk)("select",{id:"region-featured",name:"featured",class:"form-control","onUpdate:modelValue":s[3]||(s[3]=function(e){return i.value.featured=e})},R,512),[[o.u1,i.value.featured]])]),d.value.featured?((0,r.uX)(),(0,r.CE)("div",{key:0,textContent:(0,l.v_)(d.value.featured[0]),class:"form-error"},null,8,H)):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",K,[(0,r.Lk)("div",Q,[q,(0,r.Lk)("div",null,[(0,r.bo)((0,r.Lk)("select",{id:"region-ddHidden",name:"ddHidden",class:"form-control","onUpdate:modelValue":s[4]||(s[4]=function(e){return i.value.ddHidden=e})},F,512),[[o.u1,i.value.ddHidden]])]),d.value.ddHidden?((0,r.uX)(),(0,r.CE)("div",{key:0,textContent:(0,l.v_)(d.value.show_resort_fees[0]),class:"form-error"},null,8,U)):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",V,[(0,r.Lk)("div",T,[Y,(0,r.Lk)("div",null,[(0,r.bo)((0,r.Lk)("select",{id:"region-show_resort_fees",name:"show_resort_fees",class:"form-control","onUpdate:modelValue":s[5]||(s[5]=function(e){return i.value.show_resort_fees=e})},A,512),[[o.u1,i.value.show_resort_fees]])]),d.value.show_resort_fees?((0,r.uX)(),(0,r.CE)("div",{key:0,textContent:(0,l.v_)(d.value.show_resort_fees[0]),class:"form-error"},null,8,J)):(0,r.Q3)("",!0),$])])])])],8,c),z,(0,r.Lk)("div",B,[(0,r.Lk)("button",{type:"submit",class:"btn btn-success",disabled:t.value},"Save",8,G),W.value?((0,r.uX)(),(0,r.CE)("div",{key:0,class:(0,l.C4)(["alert",{"alert-success":u.value,"alert-danger":!u.value}]),textContent:(0,l.v_)(W.value)},null,10,M)):(0,r.Q3)("",!0)])],32)}}}}}]);