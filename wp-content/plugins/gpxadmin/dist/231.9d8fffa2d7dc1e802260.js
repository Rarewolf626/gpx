"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[231],{231:(e,l,a)=>{a.r(l),a.d(l,{default:()=>ie});var n=a(7829),t=a(3102),o=a(9608),d=a(6685),u={class:"modal fade",id:"hold-details-modal",tabindex:"-1",role:"dialog","aria-labelledby":"hold-details-modal-label"},i={class:"modal-dialog",role:"document"},s={class:"modal-content"},r=(0,n.Lk)("div",{class:"modal-header"},[(0,n.Lk)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[(0,n.Lk)("span",{"aria-hidden":"true"},"×")]),(0,n.Lk)("h4",{class:"modal-title",id:"hold-details-modal-label"}," Hold Details ")],-1),c={class:"modal-body"},v={key:0},k=[(0,n.Lk)("i",{class:"fa fa-spinner fa-spin",style:{"font-size":"30px"}},null,-1)],m=["textContent"],h={key:1,class:"details"},f=(0,n.Lk)("strong",null,"Owner:",-1),p=(0,n.Lk)("strong",null,"Week:",-1),b=(0,n.Lk)("strong",null,"Resort:",-1),L=(0,n.Lk)("strong",null,"Room:",-1),y=(0,n.Lk)("strong",null,"Check In:",-1),g=(0,n.Lk)("li",null,[(0,n.Lk)("strong",null,"Activity:")],-1),x={style:{"margin-left":"20px"}};const _={__name:"HoldPreview",emits:["updated"],setup:function(e,l){var a=l.expose,t=(l.emit,(0,d.KR)(!1)),_=(0,d.KR)(!1),C=(0,d.KR)(""),R=(0,d.KR)({}),w=(0,d.KR)({id:null}),E=(0,d.KR)({type:"cancel",action:"credit",amount:0}),K=function(){_.value=!1,C.value="",R.value={},w.value={id:null},E.value={type:"cancel",action:"credit",amount:0}},Q=function(){t.value=!0,axios.get("/gpxadmin/room/holds/details/",{params:{id:w.value.id}}).then((function(e){e.data.success?(w.value=e.data.hold,_.value=!0):C.value=e.data.message||"An error occurred while retrieving the hold details.",t.value=!1})).catch((function(e){var l;C.value=(null===(l=e.response)||void 0===l?void 0:l.data.message)||"An error occurred while retrieving the hold details.",t.value=!1}))};return(0,n.sV)((function(){jQuery("#hold-details-modal").on("hidden.bs.modal",(function(e){return K()}))})),a({open:function(e){t.value=!0,K(),w.value.id=e,jQuery("#hold-details-modal").modal("show"),Q()},close:function(){jQuery("#hold-details-modal").modal("hide"),K()}}),function(e,l){return(0,n.uX)(),(0,n.CE)("div",u,[(0,n.Lk)("div",i,[(0,n.Lk)("div",s,[r,(0,n.Lk)("div",c,[t.value&&!_.value?((0,n.uX)(),(0,n.CE)("div",v,k)):(0,n.Q3)("",!0),(0,n.Lk)("div",null,[C.value?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"alert alert-danger",textContent:(0,o.v_)(C.value)},null,8,m)):(0,n.Q3)("",!0),_.value?((0,n.uX)(),(0,n.CE)("div",h,[(0,n.Lk)("ul",null,[(0,n.Lk)("li",null,[f,(0,n.eW)(" "+(0,o.v_)(w.value.owner),1)]),(0,n.Lk)("li",null,[p,(0,n.eW)(" "+(0,o.v_)(w.value.week),1)]),(0,n.Lk)("li",null,[b,(0,n.eW)(" "+(0,o.v_)(w.value.resort),1)]),(0,n.Lk)("li",null,[L,(0,n.eW)(" "+(0,o.v_)(w.value.room_size),1)]),(0,n.Lk)("li",null,[y,(0,n.eW)(" "+(0,o.v_)(w.value.checkin),1)]),g,(0,n.Lk)("ul",x,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(w.value.activity,(function(e){return(0,n.uX)(),(0,n.CE)("li",{key:e.time},[(0,n.Lk)("strong",null,(0,o.v_)(e.time),1),(0,n.eW)(" "+(0,o.v_)(e.action)+" by "+(0,o.v_)(e.user),1)])})),128))])])])):(0,n.Q3)("",!0)])])])])])}}};var C={class:"modal fade",id:"hold-extend-modal",tabindex:"-1",role:"dialog","aria-labelledby":"hold-details-modal-label"},R={class:"modal-dialog",role:"document"},w=(0,n.Lk)("div",{class:"modal-header"},[(0,n.Lk)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[(0,n.Lk)("span",{"aria-hidden":"true"},"×")]),(0,n.Lk)("h4",{class:"modal-title",id:"hold-extend-modal-label"}," Extend Hold ")],-1),E={class:"modal-body"},K={key:0},Q=[(0,n.Lk)("i",{class:"fa fa-spinner fa-spin",style:{"font-size":"30px"}},null,-1)],X=["textContent"],j={key:1,class:"details"},A={class:"form-group"},W=(0,n.Lk)("label",{for:"hold-extend-date"},"Release On",-1),D=["disabled","min","max"],H={class:"modal-footer"},z=(0,n.Lk)("button",{type:"button",class:"btn btn-default","data-dismiss":"modal"},"Cancel",-1),I=["disabled"];const F={__name:"HoldExtend",emits:["updated"],setup:function(e,l){var a=l.expose,u=l.emit,i=(0,d.KR)(!1),s=(0,d.KR)(!1),r=(0,d.KR)(""),c=(0,d.KR)({}),v=(0,d.KR)(null),k=(new Date).toISOString().split("T")[0],m=(0,d.KR)({id:null}),h=function(){s.value=!1,r.value="",c.value={},m.value={id:null},v.value=null},f=function(){i.value=!0,axios.get("/gpxadmin/room/holds/details/",{params:{id:m.value.id}}).then((function(e){e.data.success?(m.value=e.data.hold,v.value=null,s.value=!0):r.value=e.data.message||"An error occurred while retrieving the hold details.",i.value=!1})).catch((function(e){var l;r.value=(null===(l=e.response)||void 0===l?void 0:l.data.message)||"An error occurred while retrieving the hold details.",i.value=!1}))},p=function(){L.value&&(i.value=!0,r.value="",axios.post("".concat(window.ajaxurl,"?action=gpx_extend_week"),{id:m.value.id,newdate:v.value}).then((function(e){e.data.success?(u("updated"),b()):r.value=e.data.error||"An error occurred while releasing the hold.",i.value=!1})).catch((function(e){var l;r.value=(null===(l=e.response)||void 0===l?void 0:l.data.error)||"An error occurred while releasing the hold.",i.value=!1})))},b=function(){jQuery("#hold-extend-modal").modal("hide"),h()},L=(0,n.EW)((function(){return!i.value&&s.value&&v.value}));return(0,n.sV)((function(){jQuery("#hold-extend-modal").on("hidden.bs.modal",(function(e){return h()}))})),a({open:function(e){i.value=!0,h(),m.value.id=e,jQuery("#hold-extend-modal").modal("show"),f()},close:b}),function(e,l){return(0,n.uX)(),(0,n.CE)("div",C,[(0,n.Lk)("div",R,[(0,n.Lk)("form",{class:"modal-content",onSubmit:(0,t.D$)(p,["prevent"])},[w,(0,n.Lk)("div",E,[i.value&&!s.value?((0,n.uX)(),(0,n.CE)("div",K,Q)):(0,n.Q3)("",!0),(0,n.Lk)("div",null,[r.value?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"alert alert-danger",textContent:(0,o.v_)(r.value)},null,8,X)):(0,n.Q3)("",!0),s.value?((0,n.uX)(),(0,n.CE)("div",j,[(0,n.Lk)("div",null," Currently releases on "+(0,o.v_)(m.value.release_on),1),(0,n.Lk)("div",A,[W,(0,n.bo)((0,n.Lk)("input",{type:"date",class:"form-control",id:"hold-extend-date",disabled:i.value,min:(0,d.R1)(k),max:m.value.checkin_iso,"onUpdate:modelValue":l[0]||(l[0]=function(e){return v.value=e})},null,8,D),[[t.Jo,v.value]])])])):(0,n.Q3)("",!0)])]),(0,n.Lk)("div",H,[z,(0,n.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:!L.value},"Extend Hold",8,I)])],32)])])}}};var O={class:"modal fade",id:"hold-release-modal",tabindex:"-1",role:"dialog","aria-labelledby":"hold-release-modal-label"},S={class:"modal-dialog",role:"document"},V={class:"modal-content"},$=(0,n.Lk)("div",{class:"modal-header"},[(0,n.Lk)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[(0,n.Lk)("span",{"aria-hidden":"true"},"×")]),(0,n.Lk)("h4",{class:"modal-title",id:"hold-release-modal-label"}," Release Hold ")],-1),U={class:"modal-body"},G={key:0},N=[(0,n.Lk)("i",{class:"fa fa-spinner fa-spin",style:{"font-size":"30px"}},null,-1)],P=["textContent"],q={key:1,class:"details"},J=[(0,n.Lk)("button",{type:"button",class:"btn btn-default","data-dismiss":"modal"},"Cancel",-1),(0,n.Lk)("button",{type:"submit",class:"btn btn-primary"},"Release Hold",-1)];const T={__name:"HoldRelease",emits:["updated"],setup:function(e,l){var a=l.expose,u=l.emit,i=(0,d.KR)(!1),s=(0,d.KR)(!1),r=(0,d.KR)(""),c=(0,d.KR)({}),v=(0,d.KR)({id:null}),k=function(){s.value=!1,r.value="",c.value={},v.value={id:null}},m=function(){i.value=!0,axios.get("/gpxadmin/room/holds/details/",{params:{id:v.value.id}}).then((function(e){e.data.success?(v.value=e.data.hold,s.value=!0):r.value=e.data.message||"An error occurred while retrieving the hold details.",i.value=!1})).catch((function(e){var l;r.value=(null===(l=e.response)||void 0===l?void 0:l.data.message)||"An error occurred while retrieving the hold details.",i.value=!1}))},h=function(){i.value=!0,axios.post("".concat(window.ajaxurl,"?action=gpx_release_week"),{id:v.value.id}).then((function(e){e.data.success?(u("updated"),f()):r.value=e.data.message||"An error occurred while releasing the hold.",i.value=!1})).catch((function(e){var l;r.value=(null===(l=e.response)||void 0===l?void 0:l.data.message)||"An error occurred while releasing the hold.",i.value=!1}))},f=function(){jQuery("#hold-release-modal").modal("hide"),k()};return(0,n.sV)((function(){jQuery("#hold-release-modal").on("hidden.bs.modal",(function(e){return k()}))})),a({open:function(e){i.value=!0,k(),v.value.id=e,jQuery("#hold-release-modal").modal("show"),m()},close:f}),function(e,l){return(0,n.uX)(),(0,n.CE)("div",O,[(0,n.Lk)("div",S,[(0,n.Lk)("div",V,[$,(0,n.Lk)("div",U,[i.value&&!s.value?((0,n.uX)(),(0,n.CE)("div",G,N)):(0,n.Q3)("",!0),(0,n.Lk)("div",null,[r.value?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"alert alert-danger",textContent:(0,o.v_)(r.value)},null,8,P)):(0,n.Q3)("",!0),s.value?((0,n.uX)(),(0,n.CE)("div",q," Are you sure you want to release the hold? ")):(0,n.Q3)("",!0)])]),(0,n.Lk)("form",{class:"modal-footer",onSubmit:(0,t.D$)(h,["prevent"])},J,32)])])])}}};var B={key:0},M=[(0,n.Lk)("i",{class:"fa fa-spinner fa-spin",style:{"font-size":"30px"}},null,-1)],Y={key:1,class:"table-responsive"},Z={class:"table data-table table-bordered table-condensed table-left"},ee=(0,n.Lk)("thead",null,[(0,n.Lk)("tr",null,[(0,n.Lk)("th"),(0,n.Lk)("th",null,"Owner Name"),(0,n.Lk)("th",null,"GPR ID"),(0,n.Lk)("th",null,"Week ID"),(0,n.Lk)("th",null,"Resort"),(0,n.Lk)("th",null,"Room Size"),(0,n.Lk)("th",null,"Check In"),(0,n.Lk)("th",null,"Release On"),(0,n.Lk)("th",null,"Released")])],-1),le={style:{display:"flex","justify-content":"start","align-items":"center",gap:"5px"}},ae=["onClick"],ne=[(0,n.Lk)("i",{class:"fa fa-eye"},null,-1)],te=["onClick"],oe=[(0,n.Lk)("i",{class:"fa fa-calendar-plus-o"},null,-1)],de=["onClick"],ue=[(0,n.Lk)("i",{class:"fa fa-calendar-times-o"},null,-1)];const ie={__name:"RoomHolds",props:{id:{type:Number,required:!0}},setup:function(e){var l=e,a=(0,d.KR)(!1),u=(0,d.KR)([]),i=(0,d.KR)(null),s=(0,d.KR)(null),r=(0,d.KR)(null),c=function(){a.value=!1,axios.get("/gpxadmin/room/holds/?id=".concat(l.id)).then((function(e){u.value=e.data,a.value=!0}))};return(0,n.sV)((function(){c()})),function(e,l){return(0,n.uX)(),(0,n.CE)("div",null,[a.value?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",B,M)),a.value&&u.value.length>0?((0,n.uX)(),(0,n.CE)("div",Y,[(0,n.Lk)("table",Z,[ee,(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(u.value,(function(e){return(0,n.uX)(),(0,n.CE)("tr",{key:e.id},[(0,n.Lk)("td",le,[(0,n.Lk)("button",{type:"button",class:"btn btn-default btn-plain",onClick:(0,t.D$)((function(l){return i.value.open(e.id)}),["prevent"])},ne,8,ae),(0,n.bo)((0,n.Lk)("button",{type:"button",class:"btn btn-default btn-plain",onClick:(0,t.D$)((function(l){return s.value.open(e.id)}),["prevent"]),title:"Extend Week"},oe,8,te),[[t.aG,e.can_extend]]),(0,n.bo)((0,n.Lk)("button",{type:"button",class:"btn btn-default btn-plain",onClick:(0,t.D$)((function(l){return r.value.open(e.id)}),["prevent"]),title:"Release Week"},ue,8,de),[[t.aG,e.can_release]])]),(0,n.Lk)("td",null,(0,o.v_)(e.owner),1),(0,n.Lk)("td",null,(0,o.v_)(e.user),1),(0,n.Lk)("td",null,(0,o.v_)(e.week),1),(0,n.Lk)("td",null,(0,o.v_)(e.resort),1),(0,n.Lk)("td",null,(0,o.v_)(e.room_size),1),(0,n.Lk)("td",null,(0,o.v_)(e.checkin),1),(0,n.Lk)("td",null,(0,o.v_)(e.release_on),1),(0,n.Lk)("td",null,(0,o.v_)(e.released),1)])})),128))])])])):(0,n.Q3)("",!0),(0,n.bF)(_,{ref_key:"details",ref:i,onUpdated:c},null,512),(0,n.bF)(F,{ref_key:"extend",ref:s,onUpdated:c},null,512),(0,n.bF)(T,{ref_key:"release",ref:r,onUpdated:c},null,512)])}}}}}]);