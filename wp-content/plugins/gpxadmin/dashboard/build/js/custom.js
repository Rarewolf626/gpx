!function(t){jQuery.fn[t]=function(e){return e?this.bind("resize",(a=e,function(){var e=this,t=arguments;i?clearTimeout(i):o&&a.apply(e,t),i=setTimeout(function(){o||a.apply(e,t),i=null},r||100)})):this.trigger(t);var a,r,o,i}}((jQuery,"smartresize")),window.axios&&(window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest");var CURRENT_URL=window.location.href.split("?")[0],$BODY=jQuery("body"),$MENU_TOGGLE=jQuery("#menu_toggle"),$SIDEBAR_MENU=jQuery("#sidebar-menu"),$SIDEBAR_FOOTER=jQuery(".sidebar-footer"),$LEFT_COL=jQuery(".left_col"),$RIGHT_COL=jQuery(".right_col"),$NAV_MENU=jQuery(".nav_menu"),$FOOTER=jQuery("footer"),checkState=(jQuery(document).ready(function(i){var e=0;jQuery(".gpxRW .title_left").click(function(){4<++e&&(jQuery("input, button, select, textarea").prop("disabled",!1),jQuery(".select2").select2())}),jQuery("#reportType").change(function(){jQuery("#name, #reportWriterSubmit").prop("disabled",!1)}),jQuery(".date-filter-control").datepicker().on("change",function(e){jQuery(e.currentTarget).keyup()}),jQuery("html body").on("change",".bootstrap-table-filter-control-ExpiryDate",function(){var e=jQuery(this),t=jQuery.Event("keydown");t.which=13,jQuery(e).trigger(t)}),jQuery("#transactionReport").click(function(e){e.preventDefault();e=jQuery(this).attr("href");jQuery("#gpxModal").modal("show"),jQuery("#gpxModal .modal-body").html('<form action="'+e+'" method="GET"><input type="hidden" name="action" value="gpx_csv_download" /><input type="hidden" name="table" value="wp_gpxTransactions" /><input type="hidden" name="column" value="transactionData" /><div class="form-row"><label>Date From</label><input type="date" class="form-control" name="datefrom" placeholder="Date From" /></div><div class="form-row" style="margin: 20px 0;"><label>Date To</label><input type="date" class="form-control" name="dateto" placeholder="Date To" /><br /><br /><input type="submit" name="submit" value="Generate Report" class="btn btn-primary"></div></form>')}),jQuery("html body .modal-body").on("click",".dropdown-item",function(){var e=i(this).data("type"),t=i(this).text();jQuery(this).closest(".input-group-btn").find(".dropdown-toggle").text(t),jQuery(this).closest(".input-group").find(".refundType").val(e),jQuery(this).closest(".input-group").find('input[type="submit"]').show()}),jQuery("html body").on("click",".update-transaction-fee",function(){i(this).attr("disabled",!0),i(this).prop("disabled",!0);var t=jQuery(this).append('<i class("fa  fa-spinner fa-pulse"></i>'),e=jQuery(this).closest(".modal-body").find(".input-group"),a=jQuery(e).find("input.feeamt").val(),r=jQuery(e).find("input.feeamt").data("type"),e=jQuery(e).find(".refundType").val(),o=jQuery("#transactionID").val();jQuery.ajax({type:"POST",url:"admin-ajax.php?action=gpx_transaction_fees_adjust",data:{id:o,amount:a,refundType:e,type:r},success:function(e){e.success?location.reload():jQuery("#feeupdate .modal-body").append(e.html),jQuery(t).remove()}})}),jQuery("html body").on("click",".refresh-fee",function(){location.reload()}),jQuery("html body").on("click",".feeupdate",function(){var e=jQuery(this).closest(".modal-btn-group").find(".updateoptions").html(),t=jQuery(this).data("type");jQuery("#updateType").text(t),jQuery("#feeupdate .modal-body").html(e)}),jQuery("html body").on("click",".credit-extend",function(){var e=jQuery(this).data("id");jQuery("#creID").val(e)}),jQuery("html body").on("submit",".creditExtForm",function(e){e.preventDefault();e=jQuery(this).serialize();jQuery.ajax({type:"POST",url:"admin-ajax.php?&action=creditExtention&"+e,contentType:!1,processData:!1,success:function(e){jQuery("#creModal").modal("hide"),jQuery("#depositTable").find('button[name="refresh"]').trigger("click")}})}),jQuery("#csv_file_button").on("click",function(e){e.preventDefault(),tb_show("","media-upload.php?type=image&amp;TB_iframe=true")}),jQuery("#submit-csv").on("click",function(e){e.preventDefault();e=jQuery("#csv_file").val();jQuery.ajax({url:"admin-ajax.php?&action=csv_upload",type:"POST",data:{file_url:e},success:function(e){e?"error"!=e[0]?(jQuery("#sucessmessage").html(e[1]),jQuery("#sucessmessage").css("display","block")):(jQuery("#myModal").modal(),jQuery("#importerror").html(e[1])):alert("Web Services Failed")}})}),window.send_to_editor=function(e){url=i(e).attr("href"),i("#csv_file").val(url),tb_remove()}}),jQuery(document).ready(function(){function a(){jQuery(".right_col").css("min-height",jQuery(window).height());var e=jQuery(".dashboard_body").outerHeight(),t=jQuery(".dashboard_body").hasClass("footer_fixed")?-10:jQuery("footer").height(),a=jQuery(".left_col").eq(1).height()+jQuery(".sidebar-footer").height(),a=e<a?a:e;a-=jQuery(".nav_menu").height()+t,jQuery(".right_col").css("min-height",a)}jQuery("#sidebar-menu").find("a").on("click",function(e){var t=jQuery(this).parent();t.is(".active")?(t.removeClass("active active-sm"),jQuery("ul:first",t).slideUp(function(){a()})):(t.parent().is(".child_menu")||(jQuery("#sidebar-menu").find("li").removeClass("active active-sm"),jQuery("#sidebar-menu").find("li ul").slideUp()),t.addClass("active"),jQuery("ul:first",t).slideDown(function(){a()}))}),jQuery("#menu_toggle").on("click",function(){jQuery(".dashboard_body").hasClass("nav-md")?(jQuery("#sidebar-menu").find("li.active ul").hide(),jQuery("#sidebar-menu").find("li.active").addClass("active-sm").removeClass("active")):(jQuery("#sidebar-menu").find("li.active-sm ul").show(),jQuery("#sidebar-menu").find("li.active-sm").addClass("active").removeClass("active-sm")),jQuery(".dashboard_body").toggleClass("nav-md nav-sm"),a()}),jQuery("#sidebar-menu").find('a[href="'+CURRENT_URL+'"]').parent("li").addClass("current-page"),jQuery("#sidebar-menu").find("a").filter(function(){return this.href==CURRENT_URL}).parent("li").addClass("current-page").parents("ul").slideDown(function(){a()}).parent().addClass("active"),jQuery(window).smartresize(function(){a()}),a(),jQuery.fn.mCustomScrollbar&&jQuery(".menu_fixed").mCustomScrollbar({autoHideScrollbar:!0,theme:"minimal",mouseWheel:{preventDefault:!0}}),jQuery(".ms-filtered").multiselect({enableFiltering:!0}),jQuery(".multiselect").multiselect({})}),jQuery(document).ready(function(){jQuery(".collapse-link").on("click",function(){var e=jQuery(this).closest(".x_panel"),t=jQuery(this).find("i"),a=e.find(".x_content");e.attr("style")?a.slideToggle(200,function(){e.removeAttr("style")}):(a.slideToggle(200),e.css("height","auto")),t.toggleClass("fa-chevron-up fa-chevron-down")}),jQuery(".close-link").click(function(){jQuery(this).closest(".x_panel").remove()})}),jQuery(document).ready(function(){jQuery('[data-toggle="tooltip"]').tooltip({container:"body"})}),jQuery(".progress .progress-bar")[0]&&jQuery(".progress .progress-bar").progressbar(),jQuery(document).ready(function(){jQuery(".js-switch")[0]&&Array.prototype.slice.call(document.querySelectorAll(".js-switch")).forEach(function(e){new Switchery(e,{color:"#26B99A"})})}),jQuery(document).ready(function(){jQuery("input.flat")[0]&&jQuery(document).ready(function(){jQuery("input.flat").iCheck({checkboxClass:"icheckbox_flat-green",radioClass:"iradio_flat-green"})}),jQuery("#source").on("change",function(){var e=jQuery(this).val();1==e||3==e?jQuery("#sourcepartnerfield").removeClass("hide"):jQuery("#sourcepartnerfield").addClass("hide")}),jQuery(document).ready(function(){jQuery(".select2").select2()}),jQuery(".select2autocomplete").change(function(){var e=jQuery("#source").val();jQuery(this).select2({ajax:{url:"/wp-admin/admin-ajax.php?action=partner_autocomplete&type="+e,dataType:"json",processResults:function(e){return{results:$.map(e.items,function(e){return{text:e.text,id:e.id}})}}}})}),jQuery("#autocomplete").autocomplete({source:function(e,t){jQuery.ajax({url:"admin-ajax.php?&action=partner_autocomplete",type:"post",dataType:"json",data:{search:e.term,type:jQuery("#source").val()},success:function(e){t(e)}})},select:function(e,t){return jQuery("#autocomplete").val(t.item.label),jQuery("#source_partner_id").val(t.item.value),!1}}),jQuery("#autocompleteAvailability").autocomplete({source:function(e,t){jQuery.ajax({url:"admin-ajax.php?&action=partner_autocomplete",type:"post",dataType:"json",data:{search:e.term,type:jQuery("#availability").val(),availabilty:!0},success:function(e){t(e)}})},select:function(e,t){return jQuery("#autocompleteAvailability").val(t.item.label),jQuery("#available_to_partner_id").val(t.item.value),!1}});jQuery("#resort_confirmation_number").on("blur",function(){var t=jQuery("#resort_confirmation_number").val(),a=jQuery("#resort").val(),e=jQuery("#count").val();1<e&&jQuery("#resort_confirmation_number").val(""),""==a||"0"==a||1<e||""!=t&&jQuery.ajax({url:"admin-ajax.php?&action=resort_confirmation_number",type:"post",dataType:"json",data:{resortConfirmation:t,resort:a},success:function(e){""!=e?(jQuery("#resorterror").removeClass("form_error"),jQuery("#resorterror").addClass("form_error"),jQuery("#resort_confirmation_number").siblings("span").text("Resort Confirmation  number ("+t+") already taken"),"0"!==a&&(jQuery("#resort_confirmation_number").focus().val(""),jQuery("#resort_confirmation_number").attr("data-parsley-value",""))):(jQuery("#resorterror").removeClass("form_error"),jQuery("#resorterror").text(""),jQuery("#resort_confirmation_number").attr("data-parsley-value",t),0)}})}),jQuery("html body").on("change","#resort",function(){var t=jQuery("#resort_confirmation_number").val(),e=jQuery("#resort").val(),a=jQuery("#count").val();1<a&&jQuery("#resort_confirmation_number").val(""),""==t||1<a?0:jQuery.ajax({url:"admin-ajax.php?&action=resort_confirmation_number",type:"post",dataType:"json",data:{resortConfirmation:t,resort:e},success:function(e){""!=e?(jQuery("#resorterror").removeClass("form_error"),jQuery("#resorterror").addClass("form_error"),jQuery("#resort_confirmation_number").siblings("span").text("Resort Confirmation number ("+t+") already taken"),jQuery("#resort_confirmation_number").focus().val(""),jQuery("#resort_confirmation_number").attr("data-parsley-value","")):(jQuery("#resorterror").removeClass("form_error"),jQuery("#resort_confirmation_number").attr("data-parsley-value",t),jQuery("#resorterror").text(""),0)}})}),jQuery("html body").on("change","#count",function(){1<jQuery("#count").val()&&(jQuery("#resorterror").removeClass("form_error").text(""),jQuery("#resort_confirmation_number").val(""),jQuery("#resort_confirmation_number").attr("data-parsley-value","")),jQuery("#resort_confirmation_number").trigger("blur")}),jQuery("#check_in_date").datepicker({minDate:0,onSelect:function(e){var t,a=jQuery(this).datepicker("getDate"),r=jQuery(this).datepicker("getDate");a&&(t=new Date(a.getFullYear()-1,a.getMonth(),1),r.setDate(r.getDate()+1),a.setDate(a.getDate()+7)),jQuery("#check_out_date").datepicker("destroy").datepicker({dateFormat:"mm/dd/yy",minDate:r}).datepicker("setDate",a),jQuery("#active_specific_date").datepicker({dateFormat:"mm/dd/yy"}).datepicker("setDate",t)}}),jQuery("html body").on("change","#resort",function(){var e=jQuery("#resort option:selected").val();jQuery.ajax({url:"admin-ajax.php?&action=get_unit_type",type:"POST",data:{resort:e},success:function(e){var a=jQuery("#unit_type_id");a.empty(),a.append("<option value='0'>Please Select</option>"),jQuery.each(e,function(e,t){e=jQuery("<option/>",{value:e,text:t});a.append(e)})}})}),jQuery("#check_in_date").datepicker({dateFormat:"mm/dd/yy",onSelect:function(e){var t=jQuery(this).datepicker("getDate");jQuery("#check_out_date").datepicker("option",{minDate:t})}}),jQuery("#rental_push_date").datepicker({dateFormat:"mm/dd/yy"}),jQuery("#check_out_date").datepicker({dateFormat:"mm/dd/yy"}),jQuery("#active_specific_date").datepicker({dateFormat:"mm/dd/yy"}),jQuery("#roomaddForm").parsley(),setTimeout(function(){jQuery("#active_display_date").hide()}),jQuery("html body").on("click",".show_active_date",function(){jQuery(this).is(":checked")&&jQuery("#active_display_date").show()}),jQuery("html body").on("click",".hide_active_date",function(){jQuery(this).is(":checked")&&jQuery("#active_display_date").hide()}),jQuery("html body").on("change","#active_type",function(){jQuery("#active_week_month, #active_specific_date").hide();var e=jQuery(this).val();"date"==e?jQuery("#active_specific_date").show():e&&jQuery("#active_week_month").show()}),jQuery("html body").on("click","#roomaddsubmitclear, #roomaddsubmit",function(e){e.preventDefault();var t=jQuery(this).data("clear"),a=jQuery(this).closest("form"),e=jQuery("#check_in_date").val(),r=jQuery("#check_out_date").val(),o=jQuery("#active_specific_date").val(),i=jQuery("#active_week_month_sel").val(),n=jQuery("#active_type").val(),s=jQuery("#unit_type_id").val(),u=jQuery("#source").val(),c=jQuery("#resort").val(),l=jQuery("#source_partner_id").val(),d=jQuery("#resort_confirmation_number").val(),y=jQuery("input[type='radio']:checked").val(),p=jQuery("#availability").val(),j=jQuery("#available_to_partner_id").val(),Q=jQuery("#type").val(),h=jQuery("#rental_push").val(),m=jQuery("#count").val(),f=jQuery("#note").val(),g=jQuery("#price").val();jQuery("#roomaddForm").parsley().isValid()&&jQuery.ajax({url:"admin-ajax.php?&action=room_Form",type:"POST",data:{check_in_date:e,check_out_date:r,active_specific_date:o,active_week_month:i,active_type:n,unit_type_id:s,source:u,resort:c,source_partner_id:l,resort_confirmation_number:d,active:y,availability:p,available_to_partner_id:j,type:Q,note:f,price:g,rental_push:h,count:m},success:function(e){e&&e.success?(jQuery("#myModal").modal(),"clear"==t?(jQuery(a).find("input, select").val(null).trigger("change"),jQuery('button[name="refresh"]').trigger("click"),jQuery(a).find("#Radio1").val("1").trigger("click")):jQuery("#resort_confirmation_number").val(null).trigger("change")):alert("Web Services Failed")},error:function(){alert("Web Services Failed")}})});var e=jQuery("#source").val(),e=(1==e?(jQuery("#sourcepartnerfield").removeClass("hide"),jQuery("#source_partner_id").val("")):3==e?jQuery("#sourcepartnerfield").removeClass("hide"):(jQuery("#sourcepartnerfield").addClass("hide"),jQuery("#source_partner_id").val(""),jQuery("#autocomplete").val("")),jQuery("#type").val()),t=jQuery("#price").data("min");1==e?(jQuery("#pricewrapper").addClass("hide"),jQuery("#price").removeAttr("required"),jQuery("#price").removeAttr("min")):(jQuery("#pricewrapper").removeClass("hide"),jQuery("#pricewrapper").val(""),jQuery("#price").attr("required","required"),jQuery("#price").attr("min",t)),jQuery("html body").on("change","#type",function(){1==jQuery("#type").val()?(jQuery("#pricewrapper").addClass("hide"),jQuery("#price").removeAttr("required"),jQuery("#price").removeAttr("min")):(jQuery("#pricewrapper").removeClass("hide"),jQuery("#price").val(""),jQuery("#price").attr("required","required"),jQuery("#price").prop("min",t))}),jQuery(".room-history").hide(),jQuery(".show-history").click(function(e){e.preventDefault(),jQuery(".room-history").hide(),jQuery(this).next().toggle()}),jQuery("#roomeditForm").submit(function(e){if(e.preventDefault(),!jQuery("#roomeditForm")[0].checkValidity())return!1;var e=jQuery("#check_in_date").val(),t=jQuery("#check_out_date").val(),a=jQuery("#active_specific_date").val(),r=jQuery("#active_week_month_sel").val(),o=jQuery("#active_type").val(),i=jQuery("#resort").val(),n=jQuery("#unit_type_id").val(),s=jQuery("#source").val(),u=jQuery("#source_partner_id").val(),c=jQuery("#resort_confirmation_number").val(),l=jQuery("input[name=active][type='radio']:checked").val(),d=jQuery("#availability").val(),y=jQuery("#available_to_partner_id").val(),p=jQuery("#type").val(),j=jQuery("#room_id").val(),Q=jQuery("#price").val(),h=jQuery("#rental_push_date").val(),m=jQuery("#note").val();jQuery.ajax({url:"admin-ajax.php?&action=room_Form_edit",type:"POST",data:{room_id:j,check_in_date:e,check_out_date:t,active_specific_date:a,active_week_month:r,active_type:o,resort:i,unit_type_id:n,source:s,source_partner_id:u,resort_confirmation_number:c,active:l,availability:d,available_to_partner_id:y,type:p,note:m,price:Q,rental_push_date:h},success:function(e){e?(jQuery("#sucessmessage").html("Room details updated successfully"),jQuery("#sucessmessage").css("display","block"),jQuery("#myModal").modal()):alert("Web Services Failed")}})})}),jQuery("table input").on("ifChecked",function(){checkState="",jQuery(this).parent().parent().parent().addClass("selected"),countChecked()}),jQuery("table input").on("ifUnchecked",function(){checkState="",jQuery(this).parent().parent().parent().removeClass("selected"),countChecked()}),jQuery(document).ready(function(){jQuery("#activeCREmail").click(function(){var t=jQuery(this),a=jQuery(this).data("active");jQuery.post("admin-ajax.php?&action=gpx_switch_crEmail",{active:a},function(e){"1"==a?jQuery(t).removeClass("btn-danger").addClass("btn-success").text("Active").data("active","0"):jQuery(t).removeClass("btn-success").addClass("btn-danger").text("Inactive").data("active","1")})}),jQuery("#remove-report").click(function(){var e=jQuery(this).data("id");confirm("Are you sure you want to delete this report?  Your action cannot be undone!")&&jQuery.post("/wp-admin/admin-ajax.php?action=gpx_remove_report",{id:e},function(){window.location="/wp-admin/admin.php?page=gpx-admin-page&gpx-pg=reports_writer"})})}),"");function countChecked(){"all"===checkState&&jQuery(".bulk_action input[name='table_records']").iCheck("check"),"none"===checkState&&jQuery(".bulk_action input[name='table_records']").iCheck("uncheck");var e=jQuery(".bulk_action input[name='table_records']:checked").length;e?(jQuery(".column-title").hide(),jQuery(".bulk-actions").show(),jQuery(".action-cnt").html(e+" Records Selected")):(jQuery(".column-title").show(),jQuery(".bulk-actions").hide())}function show_region_option(e,t,a){a.length&&(a+="_");var r='<div id="'+t+'"class="form-group parent-regions parent-delete"><label class="control-label col-md-3 col-sm-3 col-xs-12" for="coupon-name">Parent Region <span class="required">*</span></label><div class="col-md-6 col-sm-6 col-xs-11"><select name="'+a+'parent[]" class="form-control col-md-7 col-xs-12 parent-region"><option></option>';return jQuery.each(e,function(e,t){r+='<option value="'+t.id+'">'+t.region+"</option>"}),r+='</select></div><div class="col-xs-1 remove-element"><i class="fa fa-trash" aria-hidden="true"></i></div></div>'}jQuery(".bulk_action input").on("ifChecked",function(){checkState="",jQuery(this).parent().parent().parent().addClass("selected"),countChecked()}),jQuery(".bulk_action input").on("ifUnchecked",function(){checkState="",jQuery(this).parent().parent().parent().removeClass("selected"),countChecked()}),jQuery(".bulk_action input#check-all").on("ifChecked",function(){checkState="all",countChecked()}),jQuery(".bulk_action input#check-all").on("ifUnchecked",function(){checkState="none",countChecked()}),jQuery(document).ready(function(){jQuery(".expand").on("click",function(){jQuery(this).next().slideToggle(200),"+"==($expand=jQuery(this).find(">:first-child")).text()?$expand.text("-"):$expand.text("+")})}),"undefined"!=typeof NProgress&&(jQuery(document).ready(function(){NProgress.start()}),jQuery(window).load(function(){NProgress.done()})),jQuery(window).load(function(){setTimeout(function(){jQuery("#active_week_month, #active_specific_date").hide()},100)}),jQuery(document).ready(function(){var e,a;a=jQuery("[title=Font]").siblings(".dropdown-menu"),jQuery.each(["Serif","Sans","Arial","Arial Black","Courier","Courier New","Comic Sans MS","Helvetica","Impact","Lucida Grande","Lucida Sans","Tahoma","Times","Times New Roman","Verdana"],function(e,t){a.append(jQuery('<li><a data-edit="fontName '+t+'" style="font-family:\''+t+"'\">"+t+"</a></li>"))}),jQuery("a[title]").tooltip({container:"body"}),jQuery(".dropdown-menu input").click(function(){return!1}).change(function(){jQuery(this).parent(".dropdown-menu").siblings(".dropdown-toggle").dropdown("toggle")}).keydown("esc",function(){this.value="",jQuery(this).change()}),jQuery("[data-role=magic-overlay]").each(function(){var e=jQuery(this),t=jQuery(e.data("target"));e.css("opacity",0).css("position","absolute").offset(t.offset()).width(t.outerWidth()).height(t.outerHeight())}),"onwebkitspeechchange"in document.createElement("input")?(e=jQuery("#editor").offset(),jQuery(".voiceBtn").css("position","absolute").offset({top:e.top,left:e.left+jQuery("#editor").innerWidth()-35})):jQuery(".voiceBtn").hide(),jQuery("#editor").wysiwyg({fileUploadError:function(e,t){var a="";"unsupported-file-type"===e?a="Unsupported format "+t:console.error("error uploading file",e,t),jQuery('<div class="alert"> <button type="button" class="close" data-dismiss="alert">&times;</button><strong>File upload error</strong> '+a+" </div>").prependTo("#alerts")}}),prettyPrint()}),jQuery("#compose, .compose-close").click(function(){jQuery(".compose").slideToggle()}),jQuery(document).ready(function(){jQuery("html body").on("change","#country_1",function(){var t=jQuery(this).closest(".usage_exclude"),a=jQuery(t).data("type"),e=jQuery(this).val(),r=jQuery(this).attr("id").split("_"),o="region_"+(parseInt(r[1])+1);jQuery(this).closest(".form-group").nextAll(".parent-regions").remove(),jQuery.get("admin-ajax.php?&action=get_gpx_region_list&country="+e,function(e){jQuery(t).find(".insert-above").before(show_region_option(e,o,a))})})}),jQuery(document).ready(function(){var t,e;function a(e){var t=jQuery(e),a=(t.find(".resort-description-edit").prop("disabled",!1),new FormData(e));t.find("fieldset").prop("disabled","disabled"),t.find(".resort-lock").removeClass("fa-unlock fa-lock").addClass("fa-spinner fa-spin").prop("disabled","disabled"),fetch(e.action,{method:"POST",body:a}).then(e=>e.json()).then(e=>{e.success?(t.find(".resort-edit-dates").val(e.key),t.find(".resort-edit").show(),t.find(".copy-alert").show()):e.alert&&alert(e.alert)}).finally(function(){t.find(".resort-lock").removeClass("fa-unlock fa-spinner fa-spin").addClass("fa-lock").prop("disabled",!1),t.find(".resort-description-edit").prop("disabled","disabled"),t.find("fieldset").prop("disabled",!1)})}function r(e,t="",a=".attribute-group"){var r,o=(e=jQuery(e).closest(a).find(".new-attribute")).val(),i=e.data("type"),n=e.data("resort"),s=e.closest(".edit-resort-group").find(".attribute-list"),u=e.closest(".repeatable").find(".dateFilterFrom").val(),c=e.closest(".repeatable").find(".dateFilterFrom").data("oldfrom"),l=e.closest(".repeatable").find(".dateFilterFrom").data("oldorder"),d=e.closest(".repeatable").find(".dateFilterTo").val(),y=e.closest(".repeatable").find(".dateFilterTo").data("oldto"),p={type:i,val:o,resort:n,from:u,oldfrom:c,oldorder:l,to:d,oldto:y};"descriptions"==t&&(r=jQuery(e).closest(a).find(".bookingpathdesc").data("active"),e=jQuery(e).closest(a).find(".resortprofiledesc").data("active"),p={type:i,val:o,resort:n,from:u,oldfrom:c,oldorder:l,to:d,oldto:y,bookingpathdesc:r,resortprofiledesc:e,descs:!0}),jQuery.ajax({url:"admin-ajax.php?&action=gpx_resort_attribute_new",type:"POST",data:p,success:function(e){e.success&&!t&&s.append('<li class="attribute-list-item" id="'+i+"-"+e.count+'" data-item="'+e.count+'">'+o+'<span class="attribute-list-item-remove"><i class="fa fa-times-circle-o"></i></span></li>'),window.location.reload()}})}jQuery("html body").on("change",".parent-region",function(){var t=jQuery(this).closest(".usage_exclude"),a=jQuery(t).data("type"),e=jQuery(this).val(),r=jQuery(this).closest(".form-group").attr("id").split("_"),o="region_"+(parseInt(r[1])+1);jQuery(this).closest(".form-group").nextAll(".parent-regions").remove(),jQuery.get("admin-ajax.php?&action=get_gpx_region_list&region="+e,function(e){0<e.length&&jQuery(t).find(".insert-above").before(show_region_option(e,o,a))})}),jQuery("#region-submit").click(function(e){e.preventDefault(),jQuery(this).find("i").show(),jQuery.post("admin-ajax.php?&action=add_gpx_region",jQuery(this).closest("form").serialize(),function(e){e.success?(jQuery("#region-submit").find("i").hide(),jQuery(".update-nag").removeClass("nag-fail").addClass("nag-success").text(e.msg).show(),"edit"!=e.type?jQuery("#new-region").attr("value",""):location.href="/wp-admin/admin.php?page=gpx-admin-page&gpx-pg=regions_all"):(jQuery("#region-submit").find("i").hide(),jQuery(".update-nag").removeClass("nag-success").addClass("nag-fail").text(e.msg).show()),setTimeout(function(){jQuery(".update-nag").hide("show")},4e3)})}),jQuery("#region-assign-submit").click(function(e){e.preventDefault(),jQuery(this).find("i").show(),jQuery.post("admin-ajax.php?&action=assign_gpx_region",jQuery(this).closest("form").serialize(),function(e){e.success?(jQuery("#region-assign-submit").find("i").hide(),jQuery(".update-nag").removeClass("nag-fail").addClass("nag-success").text(e.msg).show(),setTimeout(function(){location.href="/wp-admin/admin.php?page=gpx-admin-page&gpx-pg=regions_assignlist"},1500)):(jQuery("#region-assign-submit").find("i").hide(),jQuery(".update-nag").removeClass("nag-success").addClass("nag-fail").text(e.msg).show()),setTimeout(function(){jQuery(".update-nag").hide("show")},4e3)})}),jQuery("html body").on("click",".parent-delete label",function(){jQuery(this).closest("div").find("select").trigger("change")}),jQuery(".parent-delete label").click(function(){jQuery(this).closest("div").find("select").trigger("change")}),jQuery("html body").on("click",".remove-element",function(){var e=jQuery(this);jQuery(e).closest(".parent-delete").remove()}),jQuery(".remove-element").click(function(){var e=jQuery(this);jQuery(e).hasClass("remove-region-assign")&&jQuery(e).closest(".usage_exclude").last(".parent-regions").find(".parent-region").trigger("change"),jQuery(e).closest(".parent-delete").remove()}),jQuery(".remove-btn").click(function(){var e=jQuery(this).data("id"),t=jQuery(this).data("action"),a="promos_all";"add_gpx_region"==t&&(a="regions_all"),confirm("Are you sure you want to remove this record? This action cannot be undone!")&&(jQuery(this).find("i").show(),jQuery.post("admin-ajax.php?&action="+t,{remove:e},function(e){e.success?(jQuery("#region-submit").find("i").hide(),jQuery(".update-nag").removeClass("nag-fail").addClass("nag-success").text(e.msg).show(),jQuery("#new-region").attr("value","")):(jQuery(".remove-btn").find("i").hide(),jQuery(".update-nag").removeClass("nag-success").addClass("nag-fail").text(e.msg).show()),setTimeout(function(){jQuery(".update-nag").hide("show"),location.href="/wp-admin/admin.php?page=gpx-admin-page&gpx-pg="+a},2e3)}))}),jQuery("html body").on("click",".add-new .fa-plus",function(){var e=jQuery(this).closest(".clone-group"),t=jQuery(e).clone();jQuery(t).hasClass("cloned")||jQuery(t).addClass("cloned").find(".add-new").append('<i class="fa fa-minus" aria-hidden="true"></i>'),jQuery(t).insertAfter(e),jQuery(t).find(".hasDatepicker").removeClass("hasDatepicker").removeAttr("id"),jQuery(".rbodatepicker").datepicker()}),jQuery("html body").on("click",".add-new .fa-minus",function(){jQuery(this).closest(".clone-group").remove()}),jQuery(".ue-blackout, .ue-blackout-fg, .ue-travel, .ue-travel-fg").hide(),jQuery(".ue-blackout-fg.shown").length&&jQuery(".ue-blackout, .ue-blackout-fg").show(),jQuery(".ue-travel-fg.shown").length&&jQuery(".ue-travel, .ue-travel-fg").show(),jQuery("html body").on("click",".addBlackoutDates",function(e){e.preventDefault();var t,e=jQuery(this).closest(".clone-group");jQuery(e).find(".ue-blackout-fg").hasClass("shown")?(t=jQuery(this).closest(".clone-group").find(".ue-blackout-fg"),jQuery(t).find(".hasDatepicker").removeClass("hasDatepicker").removeAttr("id"),t=jQuery(t).remove(".cloned").clone().addClass("cloned"),jQuery(e).find(".boClone").append(t),jQuery(".rbodatepicker").datepicker()):jQuery(e).find(".ue-blackout-fg").addClass("shown").show()}),jQuery("html body").on("click",".remove-blackout",function(e){e.preventDefault();e=jQuery(this).closest(".ue-blackout-fg");jQuery(e).hasClass("cloned")?jQuery(e).remove():(jQuery(e).removeClass("shown").hide(),jQuery(e).find("input").val(""))}),jQuery("html body").on("click",".addTravelDates",function(e){e.preventDefault();var t,e=jQuery(this).closest(".clone-group");jQuery(e).find(".ue-travel-fg").hasClass("shown")?(t=jQuery(this).closest(".clone-group").find(".ue-travel-fg"),jQuery(t).find(".hasDatepicker").removeClass("hasDatepicker").removeAttr("id"),t=jQuery(t).remove(".cloned").clone().addClass("cloned"),jQuery(e).append(t),jQuery(".rbodatepicker").datepicker()):jQuery(e).find(".ue-travel-fg").addClass("shown").show()}),jQuery("html body").on("click",".blackout-clone-btn .fa-plus",function(e){e.preventDefault();var e=jQuery(this).closest(".blackout-clone-gp"),t=jQuery(e).find(".blackout-clone"),t=(jQuery(t).find(".hasDatepicker").removeClass("hasDatepicker").removeAttr("id"),jQuery(t).remove(".cloned").clone().addClass("cloned"));jQuery(e).append(t),jQuery(".datepicker").datepicker()}),jQuery("html body").on("click",".blackout-clone-btn .fa-minus",function(e){e.preventDefault(),jQuery(this).closest(".blackout-clone").remove()}),jQuery("html body").on("change",'select[name="usage_resort[]"]',function(){var e=[];jQuery('select[name="usage_resort[]"]').each(function(){e.push(jQuery(this).val())}),jQuery(".ue-blackout-fg").each(function(){jQuery(this).find(".metaResortBlackoutResorts").length?jQuery(this).find(".metaResortBlackoutResorts").val(e.join(",")):jQuery(this).append('<input type="hidden" class="metaResortBlackoutResorts" name="metaResortBlackoutResorts[]" value="['+e.join(",")+']">')}),jQuery(".ue-travel-fg").each(function(){jQuery(this).find(".metaResortTravelResorts").length?jQuery(this).find(".metaResortTravelResorts").val(e.join(",")):jQuery(this).append('<input type="hidden" class="metaResortTravelResorts" name="metaResortTravelResorts[]" value="['+e.join(",")+']">')})}),jQuery(".rbodatepicker").length&&jQuery(".rbodatepicker").removeClass("hasDatepicker").removeAttr("id"),jQuery(".rbodatepicker").datepicker({onSelect:function(e,t){var a=[];jQuery('select[name="usage_resort[]"]').each(function(){a.push(jQuery(this).val())}),jQuery(".ue-blackout-fg").each(function(){jQuery(this).find(".metaResortBlackoutResorts").length?jQuery(this).find(".metaResortBlackoutResorts").val(a.join(",")):jQuery(this).append('<input type="hidden" class="metaResortBlackoutResorts" name="metaResortBlackoutResorts[]" value="['+a.join(",")+']">')}),jQuery(".ue-travel-fg").each(function(){jQuery(this).find(".metaResortTravelResorts").length?jQuery(this).find(".metaResortTravelResorts").val(a.join(",")):jQuery(this).append('<input type="hidden" class="metaResortTravelResorts" name="metaResortTravelResorts[]" value="['+a.join(",")+']">')}),jQuery("#"+t.id).attr("value",e)}}),jQuery("html body").on("change",".switchmetausage",function(){var e=jQuery(this).val(),t=jQuery(this).closest(".clone-group");jQuery(t).find(".usage-add").html(""),jQuery.get("admin-ajax.php?action=gpx_get_switchusage&usage="+e+"&type=usage",function(e){jQuery(t).find(".usage-add").html(e.html)}),"resort"==e?jQuery(t).find(".ue-blackout, .ue-travel").show():jQuery(t).find(".ue-blackout, .ue-travel").hide()}),jQuery("html body").on("change",".switchmetaexclusions",function(){var e=jQuery(this).val(),t=jQuery(this).closest(".clone-group");jQuery.get("admin-ajax.php?action=gpx_get_switchusage&usage="+e+"&type=exclude",function(e){jQuery(t).find(".exclusion-add").html(e.html)})}),jQuery("html body").on("change",".metaCustomerResortSpecific",function(){var e=jQuery(this).val(),t=jQuery(this).closest(".clone-group");"Yes"==e?jQuery.get("admin-ajax.php?action=gpx_get_switchusage&usage=resort",function(e){jQuery(t).find(".rs-add").html(e.html)}):jQuery.get("admin-ajax.php?action=get_gpx_customers",function(e){jQuery(".rs-add").html(e.html),jQuery(".owner-list").multiselect({enableFiltering:!0})})}),jQuery("#exclusiveWeeks").change(function(){""!=jQuery(this).val()&&jQuery("#availability").val("Site-wide")}),jQuery("#availability").change(function(){"Landing Page"==jQuery(this).val()?jQuery(".exclusiveWeeksBox").hide():jQuery(".exclusiveWeeksBox").show()}),jQuery(".owner-list").multiselect({enableFiltering:!0}),jQuery(".daterange").daterangepicker(),jQuery(".advanced_date_filter").click(function(e){e.preventDefault();e=jQuery(this).data("filtertype");"clear"==e?jQuery("#filteredDates, #filterType").val(""):jQuery("#filterType").val(e),jQuery("#cr-date-filter").submit()}),jQuery("html body").on("blur","#userSearch",function(){var e=jQuery(this).val();jQuery.get("admin-ajax.php?action=get_gpx_findowner&search="+e,function(e){jQuery("#selectFromList").html(e.html)})}),jQuery("html body").on("click","#userSearchBtn",function(e){e.preventDefault()}),jQuery("html body").on("click",".ownerSelectFrom",function(e){e.preventDefault();var e=jQuery(this).data("id"),t=jQuery(this).data("name"),a=jQuery(this).data("login");jQuery("#selectToList").append('<option value="'+e+'" selected="selected">'+a+" "+t+"</option>")}),jQuery("#selectToList").length&&(t={},jQuery("#selectToList > option").each(function(){var e=jQuery(this).attr("value");jQuery(this).is(":selected")||jQuery(this).remove(),t[e]||(t[e]=!0)})),jQuery("html body").on("click",".resort-list",function(e){e.preventDefault();var t=jQuery(this).closest(".usage_exclude"),e=jQuery(t).data("type"),a=jQuery(this).closest(".row").prev().find("select");"country"==jQuery(a).attr("name")?alert("You must select a region!"):""==(a=jQuery(a).val()).length?alert("You must select a sub-region!"):jQuery.post("admin-ajax.php?action=get_gpx_list_resorts",{value:a,type:e},function(e){jQuery(t).find(".insert-resorts").prepend(e.html)})}),jQuery("#bookingFunnel").length&&("No"==jQuery("#bookingFunnel").val()?(jQuery(".promo").hide(),jQuery(".coupon")):(jQuery(".coupon").hide(),jQuery(".promo"))).show(),jQuery("#metaType").length&&("2 for 1 Deposit"==(e=jQuery("#metaType").val())?(jQuery(".two4one-hide").hide(),jQuery(".two4one-show").show(),jQuery(".dateTextSwitch").text("(Travel Period)")):(jQuery(".two4one-hide").not(".upsell").show(),jQuery(".two4one-show").hide(),jQuery(".dateTextSwitch").text("(Available for Viewing)")),"Auto Create Coupon Template -- Pct Off"==e||"Auto Create Coupon Template -- Dollar Off"==e||"Auto Create Coupon Template -- Set Amt"==e?(jQuery("#actcFG").show(),jQuery("#acCoupon").hide(),jQuery("#bookingFunnel").val("No").change()):(jQuery("#acCoupon").show(),jQuery("#actcFG, #ctSelectRow").hide())),jQuery("#acCoupon").length&&(jQuery("#acCouponField").is(":checked")?(e=jQuery("#couponTemplate").val(),jQuery("#ctSelectRow").show(),jQuery.post("admin-ajax.php?&action=gpx_get_coupon_template",{selected:e},function(e){jQuery("#couponTemplate").html(e.html)})):jQuery("#ctSelectRow").hide()),jQuery("#metaType").change(function(){var e=jQuery(this).val();"BOGO"==e||"BOGOH"==e?jQuery("#Amount").attr("disabled",!0):jQuery("#Amount").attr("disabled",!1),"Auto Create Coupon Template -- Pct Off"==e||"Auto Create Coupon Template -- Dollar Off"==e||"Auto Create Coupon Template -- Set Amt"==e?(jQuery("#actcFG").show(),jQuery("#acCoupon").hide(),jQuery("#bookingFunnel").val("No").change()):(jQuery("#acCoupon").show(),jQuery("#actcFG").hide(),jQuery("#acCouponField").is(":checked")||jQuery("#ctSelectRow").hide),"2 for 1 Deposit"==e?(jQuery("#Amount").prop("value","0"),jQuery(".two4one-hide").hide(),jQuery(".two4one-show").show(),jQuery(".dateTextSwitch").text("(Travel Period)")):(jQuery(".two4one-hide").show(),jQuery(".two4one-show").show(),jQuery(".dateTextSwitch").text("(Available for Viewing)")),jQuery("#acCouponField").is(":checked")?jQuery("#ctSelectRow").show():jQuery("#ctSelectRow").hide()}),jQuery("#acCouponField").change(function(){var e;jQuery(this).is(":checked")?(e=jQuery("#couponTemplate").val(),jQuery("#ctSelectRow").show(),jQuery.post("admin-ajax.php?&action=gpx_get_coupon_template",{selected:e},function(e){jQuery("#couponTemplate").html(e.html)})):jQuery("#ctSelectRow").hide()}),jQuery("#metaTransactionType").blur(function(){var e=jQuery(this).val();-1!==jQuery.inArray("upsell",e)||"upsell"==e?jQuery(".upsell").show():jQuery(".upsell").hide()}),jQuery("#bookingFunnel").change(function(){"No"==jQuery(this).val()?(jQuery("#promoorcoupon").text("Coupon Code"),jQuery(".coupon").show(),jQuery(".promo").hide(),jQuery(".pcSwitchType").text("Coupon")):(jQuery("#promoorcoupon").text("Slug"),jQuery(".coupon").hide(),jQuery(".promo").show(),jQuery(".pcSwitchType").text("Promo"))}),jQuery("#Name").blur(function(){var e=jQuery(this).val();jQuery("#Slug").val()||(e=(e=(e=(e=(e=(e=e.replace(/\s/g,"-")).replace("$","")).replace("!","")).replace("@","")).replace("#","")).replace("&","-and-"),jQuery("#Slug").val(e))}),jQuery(".timepicker").timepicker(),jQuery(".datepicker").datepicker(),jQuery(".fapicker").iconpicker(),jQuery("#StartDate").change(function(){var e=jQuery(this).val();0==jQuery("#metaBookStartDate").val().length&&jQuery("#metaBookStartDate").val(e),0==jQuery("#metaTravelStartDate").val().length&&jQuery("#metaTravelStartDate").val(e)}),jQuery("#EndDate").change(function(){var e=jQuery(this).val();0==jQuery("#metaBookEndDate").val().length&&jQuery("#metaBookEndDate").val(e),0==jQuery("#metaTravelEndDate").val().length&&jQuery("#metaTravelEndDate").val(e)}),jQuery("html body").on("change","select",function(){jQuery(this).find("option").each(function(){jQuery(this).is(":selected")?jQuery(this).attr("selected","selected"):jQuery(this).removeAttr("selected")})}),jQuery("#promo-add").submit(function(e){e.preventDefault();var t=jQuery(this),e=(jQuery(".switchmetausage").each(function(){if("region"==jQuery(this).val()){var e=jQuery(this).closest(".clone-group").find(".parent-region:last").val();if("undefined"==e||""==e)return alert("You must select or remove the region"),jQuery(this).closest(".clone-group").find(".parent-region:last").focus(),!1;jQuery(t).append('<input type="hidden" name="metaSetRegion[]" value="'+e+'">')}}),jQuery(".switchmetaexclusions").each(function(){if("region"==jQuery(this).val()){var e=jQuery(this).closest(".clone-group").find(".parent-region:last").val();if("undefined"==e||""==e)return alert("You must select or remove the region"),jQuery(this).closest(".clone-group").find(".parent-region:last").focus(),!1;jQuery(t).append('<input type="hidden" name="metaSetRegionExclude[]" value="'+e+'">')}}),btoa(jQuery(t).find(".usage-exclusion-group").html())),e=(jQuery("#metaUseExc").val(e),jQuery(t).serialize());jQuery("#submit-btn").find("i").show(),jQuery.ajax({url:"admin-ajax.php?&action=add_gpx_promo",type:"POST",data:e,success:function(e){e.success?(jQuery("#submit-btn").find("i").hide(),jQuery(".update-nag").removeClass("nag-fail").addClass("nag-success").text(e.msg).show(),setTimeout(function(){location.href="/wp-admin/admin.php?page=gpx-admin-page&gpx-pg=promos_all"},1500)):(jQuery("#rsubmit-btn").find("i").hide(),jQuery(".update-nag").removeClass("nag-success").addClass("nag-fail").text(e.msg).show()),setTimeout(function(){jQuery(".update-nag").hide("show")},4e3)}})}),jQuery(".newResort").click(function(e){return e.preventDefault(),(0!=jQuery("#metaCustomerResortSpecific").length?jQuery("#metaCustomerResortSpecific"):(e=jQuery(this).data("type"),jQuery(e))).trigger("change"),jQuery("#newResort").hide(),!1}),jQuery(".title_right").on("click","#featured-resort",function(e){var t=jQuery(this).find("i"),a=jQuery(this).data("featured"),r=jQuery(this).data("resort");return jQuery.ajax({url:"admin-ajax.php?&action=featured_gpx_resort",type:"POST",data:{featured:a,resort:r},success:function(e){e.success?(jQuery(".update-nag").removeClass("nag-fail").addClass("nag-success").text(e.msg).show(),t.toggleClass("fa-square fa-check-square"),jQuery("#featured-resort").data("featured",e.status)):jQuery(".update-nag").removeClass("nag-success").addClass("nag-fail").text(e.msg).show(),setTimeout(function(){jQuery(".update-nag").hide("show")},4e3)}}),!1}),jQuery(".title_right").on("click","#ai-resort",function(e){e.preventDefault();var t=jQuery(this).find("i"),e=jQuery(this).data("ai"),a=jQuery(this).data("resort");return jQuery.ajax({url:"admin-ajax.php?&action=ai_gpx_resort",type:"POST",data:{ai:e,resort:a},success:function(e){e.success?(jQuery(".update-nag").removeClass("nag-fail").addClass("nag-success").text(e.msg).show(),t.toggleClass("fa-square fa-check-square"),jQuery("#ai-resort").data("ai",e.status)):jQuery(".update-nag").removeClass("nag-success").addClass("nag-fail").text(e.msg).show(),setTimeout(function(){jQuery(".update-nag").hide("show")},4e3)}}),!1}),jQuery(".title_right").on("click","#guest-fees",function(e){var t=jQuery(this).find("i"),a=jQuery(this).data("enabled"),r=jQuery(this).data("resort");return jQuery.ajax({url:"admin-ajax.php?&action=guest_fees_gpx_resort",type:"POST",data:{enabled:a,resort:r},success:function(e){e.success?(jQuery(".update-nag").removeClass("nag-fail").addClass("nag-success").text(e.msg).show(),t.toggleClass("fa-square fa-check-square"),jQuery("#guest-fees").data("enabled",e.status)):jQuery(".update-nag").removeClass("nag-success").addClass("nag-fail").text(e.msg).show(),setTimeout(function(){jQuery(".update-nag").hide("show")},4e3)}}),!1}),jQuery(".title_right").on("click","#third-party-deposit-fees",function(e){var t=jQuery(this),a=t.find("i"),r=t.data("resort");return jQuery.ajax({url:"admin-ajax.php?&action=gpx_resort_third_party_deposit_fees",type:"POST",data:{resort:r},success:function(e){e.success?(jQuery(".update-nag").removeClass("nag-fail").addClass("nag-success").text(e.msg).show(),e.status?(t.addClass("btn-primary").removeClass("btn-default"),a.addClass("fa-check-square").removeClass("fa-square")):(t.addClass("btn-default").removeClass("btn-primary"),a.addClass("fa-square").removeClass("fa-check-square")),t.data("active",e.status)):jQuery(".update-nag").removeClass("nag-success").addClass("nag-fail").text(e.msg).show(),setTimeout(function(){jQuery(".update-nag").hide("show")},4e3)}}),!1}),jQuery(".title_right").on("click","#active-resort",function(e){var t=jQuery(this).find("i"),a=jQuery(this).data("active"),r=jQuery(this).data("resort");return jQuery.ajax({url:"admin-ajax.php?&action=active_gpx_resort",type:"POST",data:{active:a,resort:r},success:function(e){e.success?(jQuery(".update-nag").removeClass("nag-fail").addClass("nag-success").text(e.msg).show(),t.toggleClass("fa-square fa-check-square"),jQuery("#active-resort").data("active",e.status)):jQuery(".update-nag").removeClass("nag-success").addClass("nag-fail").text(e.msg).show(),setTimeout(function(){jQuery(".update-nag").hide("show")},4e3)}}),!1}),jQuery(".title_right").on("click","#reload-resort",function(e){var t=jQuery(this).data("resort");return jQuery.ajax({url:"admin-ajax.php?&action=get_manualResortUpdate",type:"POST",data:{resort:t},success:function(e){(e.success?jQuery(".update-nag").removeClass("nag-fail").addClass("nag-success").text(e.success):jQuery(".update-nag").removeClass("nag-success").addClass("nag-fail").text("Please refresh the screen and try again.")).show(),setTimeout(function(){jQuery(".update-nag").hide("show")},4e3)}}),!1}),jQuery(".title_right").on("click","#is-gpr",function(e){var t=jQuery(this).data("gpr"),a=jQuery(this).data("resort");return jQuery("#is-gpr i").removeClass("fa-square fa-check-square"),jQuery.ajax({url:"admin-ajax.php?&action=is_gpr",type:"POST",data:{gpr:t,resort:a},success:function(e){e.success?(jQuery(".update-nag").removeClass("nag-fail").addClass("nag-success").text(e.msg).show(),jQuery("#is-gpr i").addClass(e.fastatus),jQuery("#is-gpr").data("gpr",e.status)):jQuery(".update-nag").removeClass("nag-success").addClass("nag-fail").text(e.msg).show(),setTimeout(function(){jQuery(".update-nag").hide("show")},4e3)}}),!1}),jQuery(".title_right").on("click","#featured-region",function(e){var t=jQuery(this).data("featured"),a=jQuery(this).data("region");return jQuery(".featured-status").removeClass("fa-square fa-check-square"),jQuery.ajax({url:"admin-ajax.php?&action=featured_gpx_region",type:"POST",data:{featured:t,region:a},success:function(e){e.success?(jQuery(".update-nag").removeClass("nag-fail").addClass("nag-success").text(e.msg).show(),jQuery(".featured-status").addClass(e.fastatus),jQuery("#featured-region").data("featured",e.status)):jQuery(".update-nag").removeClass("nag-success").addClass("nag-fail").text(e.msg).show(),setTimeout(function(){jQuery(".update-nag").hide("show")},4e3)}}),!1}),jQuery(".title_right").on("click","#hidden-region",function(e){e.preventDefault();var e=jQuery(this).data("hidden"),t=jQuery(this).data("region");return jQuery(".hidden-status").removeClass("fa-square fa-check-square"),jQuery.ajax({url:"admin-ajax.php?&action=hidden_gpx_region",type:"POST",data:{hidden:e,region:t},success:function(e){e.success?(jQuery(".update-nag").removeClass("nag-fail").addClass("nag-success").text(e.msg).show(),jQuery(".hidden-status").addClass(e.fastatus),jQuery("#hidden-region").data("hidden",e.status)):jQuery(".update-nag").removeClass("nag-success").addClass("nag-fail").text(e.msg).show(),setTimeout(function(){jQuery(".update-nag").hide("show")},4e3)}}),!1}),jQuery(".resort-tabs").on("click",".resort-lock",function(){jQuery(this).toggleClass("fa-lock").toggleClass("fa-unlock");var e=jQuery(this).closest(".form-group").find(".form-element");jQuery(e).prop("disabled",function(e,t){return!t})}),jQuery(".resort-tabs").on("change",".resort-edit-field",function(){a(this.closest("form"))}),jQuery(".resort-tabs").on("submit",".resort-edit-form",function(e){e.preventDefault(),a(this)}),jQuery(".resort-tabs").on("click",".copy-alert",function(){var e=jQuery(this).closest(".repeatable"),t=e.clone();t.find(".resort-lock").removeClass("fa-unlock").addClass("fa-lock"),t.find(".resort-edit-dates").val("0"),t.find(".resort-edit").hide(),t.find(".copy-alert").hide(),t.insertAfter(e),jQuery("html, body").animate({scrollTop:t.offset().top},1e3)}),jQuery(".resort-tabs").on("click",".delete-alert",function(){var t=jQuery(this).closest("form");"0"==t.find(".resort-edit-dates").val()?t.remove():confirm("Are you sure you want to remove this entry?")&&(t.find("fieldset").prop("disabled","disabled"),t.find(".resort-lock").removeClass("fa-unlock fa-lock").addClass("fa-spinner fa-spin").prop("disabled","disabled"),jQuery.ajax({url:"admin-ajax.php?&action=gpx_resort_remove_alert",type:"POST",data:{resort:t.find(".resort-edit-resort").val(),oldDates:t.find(".resort-edit-dates").val()},success:function(e){t.remove()}}))}),jQuery(".resort-tabs").on("change",".resort-general-edit",function(){r(jQuery(this),"update"),jQuery(this).attr("disabled","disabled"),jQuery(this).closest(".attribute-group").find(".resort-lock").removeClass(", fa-unlock")}),jQuery(".resort-tabs").on("change",".resort-descriptions",function(){r(jQuery(this),"descriptions",".edit-resort-group"),jQuery(this).attr("disabled","disabled"),jQuery(this).closest(".edit-resort-group").find(".resort-lock").removeClass("fa-unlock")}),jQuery(".resort-tabs").on("change",".resort-fee-edit",function(){jQuery(this).closest("form").submit()}),jQuery(".resort-tabs").on("click",".date-filter-desc, .ran-btn",function(e){e.preventDefault(),jQuery(this).closest(".repeatable").find(".edit-resort-group").each(function(){jQuery(this).find(".btn-group");r(jQuery(this),"descriptions",".edit-resort-group")})}),jQuery(".resort-tabs").on("click",".insert-attribute",function(e){e.preventDefault(),r(jQuery(this))}),jQuery(".image_alt, .image_title, .image_video").change(function(){var e=jQuery(this).data("id"),t=jQuery(this).closest("li").find(".image_title").val(),a=jQuery(this).closest("li").find(".image_alt").val();jQuery(this).closest("li").find(".image_video").val();jQuery.ajax({url:"admin-ajax.php?&action=gpx_resort_image_update_attr",type:"POST",data:{id:e,title:t,alt:a},success:function(e){e.success}})}),jQuery(".attribute-list-item").on("click",".attribute-list-item-remove",function(){var t=jQuery(this).closest("li"),e=t.data("id"),a=t.closest("form").find(".resortID").val(),r=t.closest("form").find(".new-attribute").data("type"),o=t.closest(".repeatable").find(".dateFilterFrom").val(),i=t.closest(".repeatable").find(".dateFilterTo").val();jQuery.ajax({url:"admin-ajax.php?&action=gpx_resort_attribute_remove",type:"POST",data:{item:e,type:r,resort:a,from:o,to:i},success:function(e){e.success&&(t.remove(),location.reload(!0))}})}),jQuery("#images").on("click",".sortable-image i.fa",function(){jQuery("#gpx-ajax-loading").show();var a=jQuery(this).closest("ul"),r=jQuery(this).closest("li"),e=jQuery(this).closest("form").find(".resortID").val(),t=r.data("id");jQuery.ajax({data:{image:t,resortID:e},type:"POST",url:"admin-ajax.php?&action=gpx_image_remove",success:function(e){r.remove();a.find("li").each(function(e){jQuery(this).data("id",e),jQuery(this).attr("data-id",e),jQuery(this).attr("id","image-"+e),e++}),jQuery("#gpx-ajax-loading").hide();var t=new RegExp("[?&]id=([^&#]*)").exec(window.location.search);location.href="/wp-admin/admin.php?page=gpx-admin-page&gpx-pg=resorts_edit&id="+t[0]}})}),jQuery(".resort-edit").submit(function(e){return e.preventDefault(),!1}),jQuery(".resort-fees").sortable({update:function(e,t){jQuery(this).closest("form").submit()}}),jQuery(".resort-tabs").on("submit",".resort-edit-fees-form",function(e){e.preventDefault();e=new FormData(this);jQuery(this).find("fieldset").prop("disabled",!0),jQuery("#gpx-ajax-loading").show(),fetch(this.action,{method:"POST",body:e}).then(e=>e.json()).then(e=>{var t;if(!e.success)throw(t=new Error(e.message??"Unable so save resort fees")).errors=e.errors??{},t;window.location.reload()}).catch(a=>{if(jQuery(this).find("fieldset").prop("disabled",!1),jQuery("#gpx-ajax-loading").hide(),a.errors){let t=[];Object.keys(a.errors).forEach(e=>{a.errors[e].forEach(e=>{t.push(e)})}),alert(t.join("\n"))}})}),jQuery(".resort-tabs").on("click",".resort-fees-copy",function(e){e.preventDefault(),jQuery(this).data("key")&&((e=jQuery(this).closest("form").clone()).find(".resort-fees-copy").remove(),e.find(".resort-fees-delete").data("key",null),e.find(".two-column-grid").remove(),e.attr("action","/wp-admin/admin-ajax.php?action=gpxadmin_resort_copy_fees"),jQuery("#resort-fees").append(e))}),jQuery(".resort-tabs").on("click",".resort-fees-delete",function(e){e.preventDefault(),jQuery("#resort-fees form").length<=1||(jQuery(this).data("key")?confirm("Are you sure you want to delete these fees?")&&((e=new FormData).append("resort",jQuery(this).data("resort")),e.append("key",jQuery(this).data("key")),fetch("/wp-admin/admin-ajax.php?action=gpxadmin_resort_delete_fees",{method:"POST",body:e}).then(e=>e.json()).then(e=>{var t;if(!e.success)throw(t=new Error(e.message??"Unable so delete resort fees")).errors=e.errors??{},t;window.location.reload()}).catch(a=>{if(jQuery(this).find("fieldset").prop("disabled",!1),jQuery("#gpx-ajax-loading").hide(),a.errors){console.log(a.errors);let t=[];Object.keys(a.errors).forEach(e=>{a.errors[e].forEach(e=>{t.push(e)})}),alert(t.join("\n"))}})):jQuery(this).closest("form").remove())}),jQuery(".resort-tabs").on("click",".resort-fees-item-remove",function(e){e.preventDefault();e=jQuery(this).closest("form");jQuery(this).closest("li").remove(),e.submit()}),jQuery(".resort-tabs").on("mouseenter",".attribute-list",function(){jQuery(this).sortable({update:function(e,t){jQuery("#gpx-ajax-loading").show();var a=jQuery(this),r=a.parent(),o=a.sortable("serialize");o+="&resortID="+a.closest("form").find(".resortID").val()+"&type=images",jQuery.ajax({data:o,type:"POST",url:"admin-ajax.php?&action=gpx_resort_attribute_reorder",success:function(e){r.find("li").each(function(e){jQuery(this).data("id",e),jQuery(this).attr("data-id",e),jQuery(this).attr("id","image-"+e)}),jQuery("#gpx-ajax-loading").hide()}})}})}),jQuery(".resort-tabs").on("mouseenter",".images-sortable",function(){jQuery(this).sortable({update:function(e,t){jQuery("#gpx-ajax-loading").show();var a=jQuery(this),r=a.parent(),o=a.sortable("serialize");o+="&resortID="+a.closest("form").find(".resortID").val()+"&type=images",jQuery.ajax({data:o,type:"POST",url:"admin-ajax.php?&action=gpx_resort_image_reorder",success:function(e){r.find("li").each(function(e){jQuery(this).data("id",e),jQuery(this).attr("data-id",e),jQuery(this).attr("id","image-"+e)}),jQuery("#gpx-ajax-loading").hide();var t=new RegExp("[?&]id=([^&#]*)").exec(window.location.search);location.href="/wp-admin/admin.php?page=gpx-admin-page&gpx-pg=resorts_edit&id="+t[0]}})}})}),jQuery(".resort-tabs").on("mouseenter",".attribute-list",function(){jQuery(this).sortable({axis:"y",update:function(e,t){jQuery("#gpx-ajax-loading").show();var a=jQuery(this),r=a.parent(),o=a.sortable("serialize"),i=a.closest("form").find(".resortID").val(),n=a.closest("form").find(".new-attribute").data("type"),s=a.closest(".repeatable").find(".dateFilterFrom").val(),a=a.closest(".repeatable").find(".dateFilterTo").val();o+="&resortID="+i+"&type="+n+"&from="+s+"&to="+a,jQuery.ajax({data:o,type:"POST",url:"admin-ajax.php?&action=gpx_resort_attribute_reorder",success:function(e){r.find("li").each(function(e){jQuery(this).data("id",e),jQuery(this).attr("data-id",e),jQuery(this).attr("id",n+"-"+e)}),jQuery("#gpx-ajax-loading").hide()}})}})}),jQuery(".resort-tabs").on("click",".clone-group .fa-copy",function(){var e=jQuery(this).closest(".repeatable"),t=e.clone().insertAfter(e),e=parseInt(e.data("seq"))+10;t.attr("data-seq",e),t.find(".new-attribute").attr("disabled","disabled"),t.remove(".fa-lock").removeClass("fa-unlock"),t.find(".from-date").attr("data-oldfrom",""),t.find(".from-date").attr("data-oldorder",e),t.find(".to-date").attr("data-oldto",""),t.find(".resort-edit").hide(),jQuery("html, body").animate({scrollTop:t.offset().top},1e3)}),jQuery("html body").on("change",".from-date, .to-date",function(){jQuery(this).closest(".repeatable").find(".resort-edit").show()}),jQuery(".resort-tabs").on("click",".clone-group .fa-times-circle-o",function(){var e,t,a,r,o,i=jQuery(this);confirm("Are you sure you want to remove this entry?")&&(e=i.closest(".repeatable").find(".dateFilterFrom").val(),t=i.closest(".repeatable").find(".dateFilterFrom").data("oldorder"),a=i.closest(".repeatable").find(".dateFilterTo").val(),r=i.data("type"),o=i.data("resortid"),jQuery.ajax({data:{from:e,to:a,type:r,resortID:o,oldorder:t},type:"POST",url:"admin-ajax.php?&action=gpx_resort_repeatable_remove",success:function(e){i.closest(".repeatable").remove()}}))}),jQuery(".resort-tabs").on("click",".date-filter",function(e){e.preventDefault();var e=jQuery(this).closest(".repeatable"),o=e.find(".from-date").val(),i=e.find(".from-date").data("oldfrom"),n=e.find(".from-date").data("oldorder"),s=e.find(".to-date").val(),u=e.find(".to-date").data("oldto");e.find("form").each(function(){var e=jQuery(this).find(".attribute-list-item"),t=jQuery(this).find(".resortID").val(),a=jQuery(this).find(".attributeType").val(),r=[];e.each(function(){var e=jQuery(this).text();r.push(e)}),0!=r.length&&jQuery.ajax({url:"admin-ajax.php?&action=gpx_resort_attribute_new",type:"POST",async:!1,data:{resort:t,type:a,list:r,from:o,oldfrom:i,oldorder:n,to:s,oldto:u}})}),location.reload(!0)}),jQuery(".resort-tabs").on("click",".rf-date-filter",function(e){e.preventDefault();var a=jQuery(this).closest(".repeatable"),r=a.find(".from-date").val(),o=a.find(".from-date").data("oldfrom"),i=a.find(".from-date").data("oldorder"),n=a.find(".to-date").val(),s=a.find(".to-date").data("oldto");a.find(".fees-group").each(function(){jQuery(this).find(".new-attribute").each(function(){var e=jQuery(this).val(),t=jQuery(this).data("resort"),a=jQuery(this).data("type");0!=e.length&&jQuery.ajax({url:"admin-ajax.php?&action=gpx_resort_attribute_new",type:"POST",async:!1,data:{resort:t,type:a,val:e,from:r,oldfrom:o,oldorder:i,to:n,oldto:s}})});var e=a.find(".attribute-list"),t=e.closest(".resort-edit").find(".resortID").val();e.find("li").each(function(){var e=jQuery(this).data("fee");jQuery.ajax({url:"admin-ajax.php?&action=gpx_resort_attribute_new",type:"POST",async:!1,data:{resort:t,type:"resortFees",val:e,from:r,oldfrom:o,oldorder:i,to:n,oldto:s}})})}),location.reload(!0)}),jQuery("#tradepartner-add").submit(function(e){e.preventDefault();const r=document.getElementById("tradepartner-add-result");r.innerHTML="";e=new FormData(this);fetch(this.getAttribute("action"),{method:"post",body:e}).then(e=>e.json()).then(e=>{if(e.success)this.reset(),r.innerHTML='<div class="alert alert-success">Trade partner was added</div>';else{var t=document.createElement("div"),a=(t.setAttribute("class","alert alert-danger"),document.createElement("strong"));if(a.setAttribute("class","h4"),a.textContent=e.message||"Failed to add trade partner",t.appendChild(a),e.errors){let a=document.createElement("ul");Object.entries(e.errors).forEach(e=>{e[1].forEach(e=>{var t=document.createElement("li");t.textContent=e,a.appendChild(t)})}),t.appendChild(a)}r.appendChild(t)}})}),jQuery("html body").on("click",".tab-click a",function(){var e=jQuery(this).attr("href");Cookies.set("resort-tab",e)}),jQuery("html body").on("focus",".emailvalidate",function(){var e;jQuery("#oldvalue").length||(e=jQuery(this).val(),jQuery(this).parent().append('<span id="oldvalue" data-val="'+e+'"></span>'))}),jQuery("html body").on("keyup",".emailvalidate",function(){jQuery(".save-return, .save-continue").prop("disabled",!0);var e=jQuery(this).parent();jQuery("#emailValidateBtn").length||jQuery('<a href="#" id="emailValidateBtn">Validate Email</a>').insertAfter(e)}),jQuery(".emailvalidate").blur(function(){var e=jQuery(this).val(),t=jQuery("#oldvalue").data("val");jQuery("#emailValidateBtn").remove(),e!=t?jQuery.post("/wp-admin/admin-ajax.php?action=gpx_validate_email",{email:e},function(e){e.error&&(jQuery(".emailvalidate").val(t),alert(e.error)),jQuery(".save-return, .save-continue").prop("disabled",!1)}):jQuery(".edit-profile-btn").prop("disabled",!1).removeClass("gpx-disabled")}),jQuery("html body").on("click","#emailValidateBtn",function(e){e.preventDefault()}),jQuery(".cancel-return").click(function(e){e.preventDefault(),window.history.back()}),jQuery(".save-continue").click(function(e){e.preventDefault(),jQuery(".returnurl").val("/");e=jQuery(".user").data("cid");jQuery.post("admin-ajax.php?&action=gpx_switchusers",{cid:e},function(){Cookies.remove("gpx-cart"),jQuery(".save-return").trigger("click")})}),jQuery(".password-reset-link").click(function(e){e.preventDefault();e=jQuery(this).data("userlogin");jQuery.post("admin-ajax.php?action=request_password_reset",{user_login:e},function(e){alert("Passord reset email sent!")})}),jQuery("#submitPWReset").click(function(e){var t=jQuery("#newpwform").serialize();jQuery.post("admin-ajax.php?action=gpx_change_password",t,function(e){jQuery(".pwMsg").text(e.msg)})}),jQuery("html body").on("click",".switch_user",function(e){e.preventDefault();e=jQuery(this).data("user");jQuery.post("admin-ajax.php?&action=gpx_switchusers",{cid:e},function(){Cookies.remove("gpx-cart"),window.location.href="/"})}),jQuery("#remove_switch").click(function(){Cookies.remove("switchuser"),Cookies.remove("gpx-cart");var e=Cookies.get("switchreturn");return window.location.href=e,!1}),jQuery("#wp-admin-bar-gpx_switch").click(function(){var e=window.location.href;Cookies.set("switchreturn",e),Cookies.remove("gpx-cart")}),jQuery("html body").on("change","#adjCredit",function(){var e=jQuery(this).val(),t=jQuery(this).closest("td").find(".creditAmt");jQuery(t).data("user");jQuery.post("admin-ajax.php?&action=add_gpx_credit",{amount:e},function(e){jQuery(t).text(e)})}),jQuery("#resort-edit").submit(function(e){e.preventDefault();e=jQuery(this).serialize();"undefined"!=e&&jQuery.ajax({url:"admin-ajax.php?&action=edit_gpx_resort",type:"POST",data:e,success:function(e){e.success?(jQuery("#submit-btn").find("i").hide(),jQuery(".update-nag").removeClass("nag-fail").addClass("nag-success").text(e.msg).show(),setTimeout(function(){location.href="/wp-admin/admin.php?page=gpx-admin-page&gpx-pg=resorts_all"},1500)):(jQuery("#rsubmit-btn").find("i").hide(),jQuery(".update-nag").removeClass("nag-success").addClass("nag-fail").text(e.msg).show()),setTimeout(function(){jQuery(".update-nag").hide("show")},4e3)}})}),jQuery(".cg-btn-group .btn").click(function(){jQuery(this).addClass("btn-primary").removeClass("btn-default").siblings().removeClass("btn-primary").addClass("btn-default")}),jQuery(".cg-btn-group-checkbox .btn").click(function(){jQuery(this).toggleClass("btn-success btn-default")}),jQuery(".selectpicker").selectpicker({style:"btn-primary",liveSearch:!0}),jQuery("#taxID").on("changed.bs.select",function(e){var t=jQuery(this).val();"new"==t?jQuery("#addTax").modal("show"):(resortID=jQuery(this).data("resort"),jQuery.ajax({url:"admin-ajax.php?&action=update_gpx_resorttax_id",type:"POST",data:{resortID:resortID,taxID:t},success:function(e){(e.success?jQuery(".update-nag").removeClass("nag-fail").addClass("nag-success"):jQuery(".update-nag").removeClass("nag-success").addClass("nag-fail")).text(e.msg).show(),setTimeout(function(){jQuery(".update-nag").hide("slow")},4e3)}}))}),jQuery("#resorttax-add").submit(function(e){e.preventDefault();e=jQuery(this).serialize();"undefined"!=e&&jQuery.ajax({url:"admin-ajax.php?&action=add_gpx_resorttax",type:"POST",data:e,success:function(e){(e.success?(jQuery("#addTax").modal("hide"),jQuery(".update-nag").removeClass("nag-fail").addClass("nag-success")):jQuery(".update-nag").removeClass("nag-success").addClass("nag-fail")).text(e.msg).show()}})}),jQuery("#resorttax-edit").submit(function(e){e.preventDefault();e=jQuery(this).serialize();"undefined"!=e&&jQuery.ajax({url:"admin-ajax.php?&action=edit_gpx_resorttax",type:"POST",data:e,success:function(e){e.success?(jQuery("#addTax").modal("hide"),jQuery(".update-nag").removeClass("nag-fail").addClass("nag-success").text(e.msg).show(),setTimeout(function(){location.href="/wp-admin/admin.php?page=gpx-admin-page&gpx-pg=resorts_taxes"},3500)):jQuery(".update-nag").removeClass("nag-success").addClass("nag-fail").text(e.msg).show(),setTimeout(function(){jQuery(".update-nag").hide("slow")},4e3)}})}),jQuery('input[name="taxMethod"]').change(function(e){var t=jQuery(this).data("resort"),a=jQuery(this).val();jQuery.ajax({url:"admin-ajax.php?&action=edit_tax_method",type:"POST",data:{ResortID:t,taxMethod:a},success:function(e){(e.success?(jQuery("#addTax").modal("hide"),jQuery(".update-nag").removeClass("nag-fail").addClass("nag-success")):jQuery(".update-nag").removeClass("nag-success").addClass("nag-fail")).text(e.msg).show(),setTimeout(function(){jQuery(".update-nag").hide("slow")},4e3)}})})}),jQuery(document).ajaxComplete(function(){jQuery(".flash-msg").length&&setTimeout(function(){jQuery(".flash-msg").remove()},3e3)}),jQuery(document).ready(function(){jQuery("#transactionsTable").on("click",".guestNameTD",function(){jQuery(this).find("input").show().focus()}),jQuery("#transactionsTable").on("blur",".updateGuestName input",function(){jQuery(this).hide()})}),jQuery(document).ready(function(){jQuery("html body").on("click","tbody .guestNameTD, li.guestNameTD",function(){jQuery(".modal").modal("hide");var e=jQuery(this).find(".updateGuestName").data("fname"),t=jQuery(this).find(".updateGuestName").data("lname"),a=jQuery(this).find(".updateGuestName").data("email"),r=jQuery(this).find(".updateGuestName").data("phone"),o=jQuery(this).find(".updateGuestName").data("adults"),i=jQuery(this).find(".updateGuestName").data("children"),n=jQuery(this).find(".updateGuestName").data("owner"),s=jQuery(this).find(".updateGuestName").data("transaction");jQuery("#transactionID").val(s),jQuery("#FirstName1").val(e),jQuery("#LastName1").val(t),jQuery("#Email").val(a),jQuery("#Phone").val(r),jQuery("#Adults").val(o),jQuery("#Children").val(i),jQuery("#Owner").val(n),jQuery("#guest-details").modal("show")}),jQuery("html body").on("click",".view-mapping",function(e){e.preventDefault();e=jQuery(this).attr("href")+" #mapped";jQuery("#modal-mapped-content").load(e),jQuery("#mapped-user").modal("show")}),jQuery("html body").on("submit","#update-guest-details",function(e){e.preventDefault();e=jQuery(this).serialize();jQuery.post("admin-ajax.php?action=gpx_reasign_guest_name",e,function(e){jQuery(".modal").modal("hide");var t=localStorage.getItem("gpx-modal-back");jQuery(t).trigger("click")})}),jQuery("html body").on("click",".deleteWeek",function(e){e.preventDefault(),confirm("Are you sure you want to remove this room.  This action cannot be undone!")&&(e=jQuery(this).data("id"),jQuery.ajax({url:"admin-ajax.php?action=gpx_remove_room",type:"POST",data:{id:e},success:function(e){e.success&&jQuery("#deleteModal").modal("show")}}))}),jQuery("html body").on("change",".inventory-weeks-selected",function(e){e.preventDefault(),jQuery("#holdTillRow").hide(),$this=jQuery(".inventory-weeks-selected").find("option:selected"),"hold"==jQuery($this).data("type")&&jQuery("#holdTillRow").show()}),jQuery("html body").on("click","#inventory-bulk-hold",function(e){e.preventDefault(),$this=jQuery(".inventory-weeks-selected").find("option:selected");var t,a=[],e=jQuery($this).data("id"),r=jQuery($this).data("type"),o=jQuery("#holdTill").val();jQuery($this).closest("div.wswrap").prev(".row").find("tr").each(function(){jQuery(this).hasClass("selected")&&(t=jQuery(this).find("td:nth(2)").text(),a.push(t))}),jQuery.post("/wp-admin/admin-ajax.php?action=tp_claim_week&tp="+e,{ids:a,type:r,date:o},function(e){jQuery("#gpxModal").modal("hide"),jQuery("#tp_inventory_table").bootstrapTable("refresh"),jQuery('button[name="refresh"]').trigger("click")})}),jQuery("html body").on("submit","#tradepartner-edit",function(e){e.preventDefault();var e=jQuery(this).serialize(),t=jQuery(this).attr("action"),a=jQuery(this).closest("div").find("#msg-box");jQuery.post(t,e,function(e){jQuery(a).text("Success"),setTimeout(function(){jQuery(a).text("")},3e3)})}),jQuery("html body").on("change","#tp_claim",function(){jQuery("#tp-claim").prop("disabled",!1)}),jQuery("html body").on("click","#tp-claim",function(e){e.preventDefault(),jQuery(this).prop("disabled",!0),$this=jQuery(".tp-weeks-selected").find("option:selected");var t,a=[],e=jQuery($this).data("id"),r=jQuery($this).data("type");jQuery($this).closest("div.row").prev(".row").find("tr").each(function(){jQuery(this).hasClass("selected")&&(t=jQuery(this).find("td:nth(1)").text(),a.push(t))}),jQuery.post("/wp-admin/admin-ajax.php?action=tp_claim_week&tp="+e,{ids:a,type:r},function(e){jQuery("#gpxModal").modal("hide"),jQuery("#tp_inventory_table").bootstrapTable("refresh"),jQuery('button[name="refresh"]').trigger("click")})}),jQuery("html body").on("click",".debitModal",function(e){var t=jQuery(this).data("id"),a=jQuery(this).data("balance"),r=jQuery(this).data("name");jQuery("#debitID").val(t),jQuery("#debitBalance").text(a),jQuery("#debitName").text(r)}),jQuery("html body").on("click","#debit-submit",function(e){var t=jQuery("#debitID").val(),a=jQuery("#debit-adjust").val();jQuery.post("/wp-admin/admin-ajax.php?action=tp_debit",{id:t,amt:a},function(e){jQuery("#debitBalance").text(e.balance),setTimeout(function(){jQuery("#gpxModalBalance").modal("hide")},1500)})}),jQuery("html body").on("click",".tp-ajdust-trade-balance",function(e){var t=jQuery(this).data("tb"),t=(localStorage.setItem("data-type",t),jQuery("#editTBNoteWrapper").clone());jQuery("#gpxModal .modal-body").html(t)}),jQuery("html body").on("click","#editTBSubmit",function(e){var t=localStorage.getItem("data-type"),a=localStorage.getItem("data-user"),r=jQuery("#editTBNote").val(),o=jQuery("#editTBNum").val();jQuery.post("/wp-admin/admin-ajax.php?action=tp_adjust_balance",{note:r,num:o,user:a,type:t},function(e){e.success&&(jQuery("#editTPBalanaceMsg").html(e.html),jQuery('button[name="refresh"]').trigger("click"),setTimeout(function(){jQuery("#editTPBalanaceMsg").html(""),jQuery("#gpxModal").modal("hide")},2e3))})}),jQuery("html body").on("click",".tp-in-modal",function(e){e.preventDefault(),jQuery(".modal").hide();var e="#"+jQuery(this).attr("id"),e=(localStorage.setItem("gpx-modal-back",e),jQuery(this).data("select")),e=jQuery(this).attr("href")+" #"+e,t=jQuery(this).data("title"),a=jQuery(this).data("type"),r=jQuery(this).closest("tr").find(".data-user").data("user");localStorage.setItem("data-user",r),jQuery("#gpxModal .modal-title").text(t),jQuery("#editTPBalance button").attr("data-user",r),jQuery("#editTPBalance").show(),jQuery("#gpxModal .modal-body").load(e,function(){"inventory"==a&&jQuery("#tp_inventory_table").bootstrapTable(),"activity"==a&&jQuery("#tp_activity_table").bootstrapTable(),"add"==a&&(setTimeout(function(){jQuery("#active_week_month, #active_specific_date").hide(),jQuery("#active_display_date").hide(),jQuery(".select2").select2()},700),jQuery("#check_in_date").datepicker({minDate:0,onSelect:function(e){var t,a=jQuery(this).datepicker("getDate"),r=jQuery(this).datepicker("getDate");a&&(t=new Date(a.getFullYear()-1,a.getMonth(),1),r.setDate(r.getDate()+1),a.setDate(a.getDate()+7)),jQuery("#check_out_date").datepicker({dateFormat:"mm/dd/yy"}).datepicker({minDate:r}).datepicker("setDate",a),jQuery("#active_specific_date").datepicker({dateFormat:"mm/dd/yy"}).datepicker("setDate",t)}}),jQuery("#autocompleteAvailability").autocomplete({source:function(e,t){jQuery.ajax({url:"admin-ajax.php?&action=partner_autocomplete",type:"post",dataType:"json",data:{search:e.term,type:jQuery("#availability").val(),availabilty:!0},success:function(e){t(e)}})},select:function(e,t){return jQuery("#autocompleteAvailability").val(t.item.label),jQuery("#available_to_partner_id").val(t.item.value),!1}})),jQuery("#gpxModal").modal("show")})}),jQuery("html body").on("click",".in-modal",function(e){e.preventDefault();e=jQuery(this).attr("href")+" #admin-modal-content";jQuery("#gpxModal .modal-title").text("View Transaction"),jQuery("#gpxModal .modal-body").load(e),jQuery("#gpxModal").modal("show")}),jQuery("html body").on("click","#cancel-booking",function(e){e.preventDefault();e=jQuery(this).data("transaction");jQuery.ajax({url:"admin-ajax.php?action=gpx_cancel_booking",type:"POST",data:{transaction:e,requester:"admin"},success:function(){jQuery("#gpxModal").modal("toggle"),jQuery("#transactionsTable").bootstrapTable("refresh")}})}),jQuery("html body").on("click",".cancel-booking-choose",function(e){e.preventDefault();var e=jQuery(this).data("type"),t=(jQuery(this).data("amt"),jQuery(this).closest(".input-group").find(".feeamt")),a=jQuery(t).data("transaction"),t=jQuery(t).val(),r={};document.location.search.replace(/\??(?:([^=]+)=([^&]*)&?)/g,function(){function e(e){return decodeURIComponent(e.split("+").join(" "))}r[e(arguments[1])]=e(arguments[2])}),confirm("Are you sure you want to cancel this booking request?")&&(jQuery(".dropdown-item.submit-on-change.cancel-booking-choose").remove(),jQuery.ajax({url:"admin-ajax.php?action=gpx_cancel_booking",type:"POST",data:{transaction:a,type:e,amt:t,admin_amt:t,requester:"admin"},success:function(e){var t;"transactions_view"==r["gpx-pg"]?location.reload():(jQuery("#gpxModal").modal("hide"),jQuery("#transactionsTable").bootstrapTable("refresh"),t=localStorage.getItem("gpx-modal-back"),jQuery(t).trigger("click"),jQuery(".right-column .update-nag").html(e.html),setTimeout(function(){jQuery(".right-column .update-nag").hide()},5e3))}}))}),jQuery("#transactionAdd_OwnerID").blur(function(){var e=$(this).val();jQuery.ajax({url:"admin-ajax.php?action=gpx_get_owner_for_add_transaction",type:"GET",data:{memberNo:e},success:function(e){jquery.each(e.data,function(e,t){var a=$(this).index,r=$(this).value;$(a).val(r)})}})})}),jQuery(document).ready(function(){function e(e){var t=e,e=jQuery(t).val();jQuery.ajax({url:"admin-ajax.php?action=gpx_promo_dup_check",type:"POST",data:{slug:e},success:function(e){e.error?(t.select(),jQuery(".major-error").remove(),t.after('<span class="major-error">'+e.error+"</span>")):jQuery(".major-error").remove()}})}var t;jQuery("#welcome-email").click(function(e){e.preventDefault(),jQuery("#welcome-emails").html("");e=jQuery(this).data("resort");jQuery(this);jQuery.post("/wp-admin/admin-ajax.php?action=send_welcome_email_by_resort",{resort:e},function(e){jQuery("#welcome-emails").html(e.emails),alert(e.message)})}),jQuery("#send_welcome_email").click(function(e){e.preventDefault();e=jQuery(this).data("cid");jQuery(this);jQuery.post("/wp-admin/admin-ajax.php?action=send_welcome_email",{cid:e},function(e){e.success?alert("Email Sent "+e.msg):alert(e.message)})}),jQuery("html body").on("change","#table",function(){var e="#"+jQuery(this).val();jQuery(".reportwriter-drag").hide(),jQuery(".reportwriter-drag ul").hide(),jQuery(e).closest(".reportwriter-drag").show(),jQuery(e).show()}),jQuery(".reportwriter-drag ul, .reportwriter-drop ul").sortable({connectWith:".sortconnect"}),jQuery("#reportWriterSubmit").click(function(e){e.preventDefault();var t=[],e=jQuery("#name").val(),a=jQuery("#reportType").val(),r=jQuery("#role").val(),o=jQuery("#emailrepeat").val(),i=jQuery("#emailrecipients").val(),n=1,s={},u={},c={},l={},d=jQuery(".reportwriter-drop").html(),y=jQuery("#editid").val(),p=(jQuery(".condition").each(function(){n=jQuery(this).closest(".conditionGroup").data("gp"),s[n]=jQuery(this).val()}),jQuery(".operator").each(function(){n=jQuery(this).closest(".conditionGroup").data("gp"),u[n]=jQuery(this).val()}),jQuery(".conditionValue").each(function(){n=jQuery(this).closest(".conditionGroup").data("gp"),l[n]=jQuery(this).val()}),jQuery(".operand").each(function(){n=jQuery(this).closest(".conditionGroup").data("gp"),c[n]=jQuery(this).val()}),jQuery(".reportwriter-drop ul li").each(function(){t.push(jQuery(this).data("field"))}),JSON.stringify(s)),j=JSON.stringify(u),Q=JSON.stringify(l),h=JSON.stringify(c);jQuery.ajax({url:"/wp-admin/admin-ajax.php?action=gpx_report_write",type:"POST",data:{editid:y,name:e,data:t,reportType:a,role:r,emailrepeat:o,emailrecipients:i,gps:n,condition:p,operator:j,operand:h,conditionValue:Q,form:d},success:function(e){e.success&&(e.refresh&&window.open(e.refresh),e.link)&&jQuery("#reportLinks").append(e.link)}})}),jQuery("html body").on("change","#reportType",function(){"Group"==jQuery(this).val()?(jQuery("#groupType").removeClass("hidden").show(),jQuery("#reportName, #reportEmail").show()):("Single"==jQuery(this).val()?jQuery("#reportName, #reportEmail").hide():jQuery("#reportName, #reportEmail").show(),jQuery("#groupType").addClass("hidden").hide())}),jQuery("#reportType").length&&setTimeout(function(){"Group"==jQuery("#reportType").val()?jQuery("#groupType").removeClass("hidden").show():jQuery("#groupType").addClass("hidden").hide()},100),jQuery("#newCondition").click(function(e){e.preventDefault(),jQuery.get("/wp-admin/admin.php?page=gpx-admin-page&gpx-pg=reports_writer",function(e){newCondition=jQuery(e).find("#cgp1");e=jQuery(".conditionGroup:last").data("gp")+1;"NaN"==e&&(e=1),jQuery(newCondition).attr("id","cgp"+e).attr("data-gp",e).prepend('<input type="hidden" name="operand[1]" class="operand" value="and" /><div class="btn-group"><button class="btn btn-primary selectoperand" type="button" data-value="and">AND</button><button class="btn btn-secondary selectoperand" type="button" data-value="or">OR</button></div><br>').append('<a href="#" class="removeWell"><i class="fa fa-close"></i></a>'),jQuery("#addConditions").append(newCondition),jQuery(newCondition).find(".select2").select2()})}),jQuery("html body").on("click",".selectoperand",function(e){e.preventDefault();e=jQuery(this).data("value");jQuery(this).closest(".conditionGroup").find(".operand").val(e),jQuery(this).closest(".conditionGroup").find(".btn-primary").removeClass("btn-primary").addClass("btn-secondary"),jQuery(this).removeClass("btn-secondary").addClass("btn-primary")}),jQuery("html body").on("click",".removeWell",function(e){e.preventDefault(),jQuery(this).closest(".conditionGroup").remove()}),jQuery("html body").on("click",".credit-donation",function(e){e.preventDefault();e=jQuery(this).data("id");jQuery.ajax({url:"/wp-admin/admin-ajax.php?&action=gpx_credit_donation",type:"GET",data:{id:e},success:function(e){jQuery("#gpxModal .body").html(e)}})}),jQuery("html body").on("click",".btn-will-bank",function(e){e.preventDefault();e=$(this),e=$(e).closest("form").serialize();jQuery.post("/wp-admin/admin-ajax.php?action=gpx_credit_donation",e,function(e){})}),jQuery("html body").on("click",".extend-week",function(e){e.preventDefault(),jQuery(this).closest(".extend-box").find(".extend-input").show()}),jQuery("html body").on("click",".close_box",function(e){e.preventDefault(),jQuery(this).closest(".extend-box").find(".extend-input").hide()}),jQuery("html body").on("click",".extend-btn",function(e){e.preventDefault();var e=jQuery(this).data("id"),t=jQuery(this).closest(".extend-input").find(".extend-date"),a=jQuery(t).val();jQuery(t).closest(".extend-input").hide(),jQuery.ajax({url:"/wp-admin/admin-ajax.php?&action=gpx_extend_week",type:"POST",data:{id:e,newdate:a},success:function(e){e.error?alert(e.error):jQuery("#transactionsTable").bootstrapTable("refresh")}})}),jQuery("html body").on("click",".release-week",function(e){e.preventDefault();e=jQuery(this).data("id");jQuery(this).hide(),jQuery.ajax({url:"/wp-admin/admin-ajax.php?&action=gpx_release_week",type:"POST",data:{id:e},success:function(e){jQuery("#transactionsTable").bootstrapTable("refresh"),jQuery("#tp_activity_table").bootstrapTable("refresh")}})}),jQuery(".merge-again").click(function(e){e.preventDefault();var e=jQuery(this).data("file"),t=jQuery(this).data("id");jQuery(this).hide(),jQuery.ajax({url:"admin-ajax.php?&action=merge_again",type:"POST",data:{file:e,id:t}})}),jQuery("#Slug").blur(function(){e(jQuery(this))}),jQuery("#Slug").change(function(){e(jQuery(this))}),jQuery(".nag-fail").length&&(t=jQuery(".nag-fail").outerHeight()+41,jQuery(".nag-success").css("top",t))});